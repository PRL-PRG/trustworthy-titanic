{"cells":[{"metadata":{"_uuid":"79d3a3ee37963ff64e0169a19c07e1384f14b962","_execution_state":"idle","trusted":true},"cell_type":"code","source":"## Importing packages\n\n# This R environment comes with all of CRAN and many other helpful packages preinstalled.\n# You can see which packages are installed by checking out the kaggle/rstats docker image: \n# https://github.com/kaggle/docker-rstats\n\n\n## Running code\n\n# In a notebook, you can run a single code cell by clicking in the cell and then hitting \n# the blue arrow to the left, or by clicking in the cell and pressing Shift+Enter. In a script, \n# you can run code by highlighting the code you want to run and then clicking the blue arrow\n# at the bottom of this window.\n\n## Reading in files\n\n# You can access files from datasets you've added to this kernel in the \"../input/\" directory.\n# You can see the files added to this kernel by running the code below. \n\n\ntitanic_train <- read.csv(\"../input/train.csv\", stringsAsFactors=FALSE)\ntitanic_test<-read.csv(\"../input/test.csv\", stringsAsFactors=FALSE)\n\n#library(titanic)\n\nlibrary('ggplot2')\nlibrary('scales')\nlibrary('dplyr') \nlibrary('randomForest') \nlibrary('readr') \n\ntitanic_train<-bind_rows(titanic_train,titanic_test)\n\n\ntitanic_train$title<-gsub('(.*, )|(\\\\..*)', '', titanic_train$Name)\n#change less frequent titles\ntable(titanic_train$Sex, titanic_train$title)\n\ntitle_edit<-c('Dona', 'Lady', 'the Countess','Capt', 'Col', 'Don', \n              'Dr', 'Major', 'Rev', 'Sir', 'Jonkheer')\ntitanic_train$title[titanic_train$title=='Mlle']<-'Miss'\ntitanic_train$title[titanic_train$title=='Ms']<-'Miss'\ntitanic_train$title[titanic_train$title=='Mme']<-'Mrs'\ntitanic_train$title[titanic_train$title %in% title_edit]<-'renamed Title'\ntable(titanic_train$Sex, titanic_train$title)\n\n#know size of each family\n\ntitanic_train$famsize <- titanic_train$SibSp + titanic_train$Parch + 1\n\nggplot(titanic_train[1:891,], aes(x = famsize, fill = factor(Survived))) +\n  geom_bar(stat='count', position='dodge') +\n  scale_x_continuous(breaks=c(1:11)) +\n  labs(x = 'Family Size') \n\n#famsize>4 and survived=true is very less\n#look for missing values\n\ntitanic_train$Embarked[titanic_train$Embarked == \"\"] <- NA\nsum(is.na(titanic_train$Age))\n#replace NA with median-method 1\ntitanic_train1<-titanic_train\n\nmed<-median(titanic_train$Age,na.rm = TRUE)\n#titanic_train1$Age[titanic_train$Age==\"NA\"]=med\n\nlibrary(Hmisc)\n\n#impute missing age value using known information-method 2\n\ntitanic_train1$Age<-with(titanic_train,impute(Age,mean))\n\ntitanic_train1$Fare<-with(titanic_train,impute(Fare,median))\ntitanic_train1$Survived<-with(titanic_train,impute(Survived,0))\ntitanic_train1$Embarked<-with(titanic_train,impute(Embarked,'C'))\n\n#group family size into classes\n\ntitanic_train1$fsizeD[titanic_train1$famsize == 1] <- 1\ntitanic_train1$fsizeD[titanic_train1$famsize < 5 & titanic_train1$famsize> 1] <- 2\ntitanic_train1$fsizeD[titanic_train1$famsize> 4] <- 3\n\n\ntrain <- titanic_train1[1:891,]\ntest <- titanic_train1[892:1309,]\n\n\n# using randomForest on the training set.\n\n# Set a random seed\n\nset.seed(755)\n\n# Build the model \n\ntitanic_model <- randomForest(Survived ~   Age+\n                                Fare +  fsizeD+Pclass ,\n                              data = train,na.action = na.exclude)\n\n\n# Show model error\n\nplot(titanic_model, ylim=c(0,0.36))\nope<-predict(titanic_model,test)\n\nimportance    <- importance(titanic_model)\nOutput<- data.frame(PassengerID = test$PassengerId, Survived = ope)\nOutput$Survived[Output$Survived>0.5]=1\nOutput$Survived[Output$Survived!=1]=0\n\n\n## Saving data\n\n# If you save any files or images, these will be put in the \"output\" directory. You \n# can see the output directory by committing and running your kernel (using the \n# Commit & Run button) and then checking out the compiled version of your kernel.\nwrite.csv(Output,file=\"pred.csv\")","execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.4.2","file_extension":".r","codemirror_mode":"r"}},"nbformat":4,"nbformat_minor":1}