
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> # Load packages
> library('ggplot2') # visualization
Warning message:
package ‘ggplot2’ was built under R version 3.6.2 
> library('ggthemes') # visualization
> library('scales') # visualization
Warning message:
package ‘scales’ was built under R version 3.6.2 
> library('dplyr') # data manipulation

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

Warning message:
package ‘dplyr’ was built under R version 3.6.2 
> library('randomForest') # classification algorithm
randomForest 4.6-14
Type rfNews() to see new features/changes/bug fixes.

Attaching package: ‘randomForest’

The following object is masked from ‘package:dplyr’:

    combine

The following object is masked from ‘package:ggplot2’:

    margin

> 
> train <- read.csv('../input/train.csv', stringsAsFactors = F)
> test  <- read.csv('../input/test.csv', stringsAsFactors = F)
> 
> full  <- bind_rows(train, test) # bind training & test data
> 
> # Make variables factors into factors
> factor_vars <- c('Sex')
> full[factor_vars] <- lapply(full[factor_vars], function(x) as.factor(x))
> 
> # Split the data back into a train set and a test set
> train <- full[1:891,]
> test <- full[892:1309,]
> 
> # Build the model (note: not all possible variables are used)
> rf_model <- randomForest(factor(Survived) ~ Sex + Age + SibSp +
+                                             Parch + Fare,
+                                             data = train,
+                                             na.action=na.roughfix)
> rf_model$err.rate
             OOB         0         1
  [1,] 0.2818991 0.2079208 0.3925926
  [2,] 0.2593985 0.1859756 0.3774510
  [3,] 0.2561350 0.1670762 0.4040816
  [4,] 0.2330623 0.1450216 0.3804348
  [5,] 0.2315394 0.1532258 0.3597360
  [6,] 0.2127404 0.1293436 0.3503185
  [7,] 0.2257310 0.1471698 0.3538462
  [8,] 0.2043628 0.1425926 0.3051360
  [9,] 0.2070535 0.1383764 0.3175074
 [10,] 0.2117780 0.1491713 0.3117647
 [11,] 0.1961669 0.1318681 0.2991202
 [12,] 0.1885522 0.1220401 0.2953216
 [13,] 0.1964085 0.1311475 0.3011696
 [14,] 0.1885522 0.1329690 0.2777778
 [15,] 0.1896745 0.1275046 0.2894737
 [16,] 0.1851852 0.1202186 0.2894737
 [17,] 0.1896745 0.1275046 0.2894737
 [18,] 0.1907969 0.1256831 0.2953216
 [19,] 0.1930415 0.1311475 0.2923977
 [20,] 0.1874299 0.1220401 0.2923977
 [21,] 0.1885522 0.1293260 0.2836257
 [22,] 0.1885522 0.1238616 0.2923977
 [23,] 0.1930415 0.1311475 0.2923977
 [24,] 0.1885522 0.1256831 0.2894737
 [25,] 0.1829405 0.1238616 0.2777778
 [26,] 0.1818182 0.1238616 0.2748538
 [27,] 0.1851852 0.1183971 0.2923977
 [28,] 0.1818182 0.1165756 0.2865497
 [29,] 0.1806958 0.1202186 0.2777778
 [30,] 0.1806958 0.1183971 0.2807018
 [31,] 0.1773288 0.1183971 0.2719298
 [32,] 0.1784512 0.1202186 0.2719298
 [33,] 0.1840629 0.1220401 0.2836257
 [34,] 0.1863075 0.1220401 0.2894737
 [35,] 0.1829405 0.1202186 0.2836257
 [36,] 0.1863075 0.1238616 0.2865497
 [37,] 0.1818182 0.1220401 0.2777778
 [38,] 0.1818182 0.1238616 0.2748538
 [39,] 0.1896745 0.1293260 0.2865497
 [40,] 0.1829405 0.1238616 0.2777778
 [41,] 0.1885522 0.1311475 0.2807018
 [42,] 0.1874299 0.1293260 0.2807018
 [43,] 0.1885522 0.1275046 0.2865497
 [44,] 0.1907969 0.1329690 0.2836257
 [45,] 0.1930415 0.1347905 0.2865497
 [46,] 0.1919192 0.1347905 0.2836257
 [47,] 0.1907969 0.1366120 0.2777778
 [48,] 0.1919192 0.1366120 0.2807018
 [49,] 0.1952862 0.1329690 0.2953216
 [50,] 0.1907969 0.1293260 0.2894737
 [51,] 0.1896745 0.1293260 0.2865497
 [52,] 0.1952862 0.1293260 0.3011696
 [53,] 0.1997755 0.1329690 0.3070175
 [54,] 0.1907969 0.1311475 0.2865497
 [55,] 0.1919192 0.1311475 0.2894737
 [56,] 0.1885522 0.1275046 0.2865497
 [57,] 0.1896745 0.1275046 0.2894737
 [58,] 0.1863075 0.1220401 0.2894737
 [59,] 0.1863075 0.1220401 0.2894737
 [60,] 0.1851852 0.1202186 0.2894737
 [61,] 0.1840629 0.1183971 0.2894737
 [62,] 0.1840629 0.1220401 0.2836257
 [63,] 0.1829405 0.1220401 0.2807018
 [64,] 0.1806958 0.1183971 0.2807018
 [65,] 0.1829405 0.1220401 0.2807018
 [66,] 0.1840629 0.1220401 0.2836257
 [67,] 0.1840629 0.1220401 0.2836257
 [68,] 0.1818182 0.1183971 0.2836257
 [69,] 0.1851852 0.1256831 0.2807018
 [70,] 0.1829405 0.1220401 0.2807018
 [71,] 0.1795735 0.1165756 0.2807018
 [72,] 0.1851852 0.1220401 0.2865497
 [73,] 0.1829405 0.1183971 0.2865497
 [74,] 0.1818182 0.1165756 0.2865497
 [75,] 0.1829405 0.1183971 0.2865497
 [76,] 0.1806958 0.1129326 0.2894737
 [77,] 0.1840629 0.1165756 0.2923977
 [78,] 0.1829405 0.1129326 0.2953216
 [79,] 0.1851852 0.1147541 0.2982456
 [80,] 0.1851852 0.1165756 0.2953216
 [81,] 0.1806958 0.1147541 0.2865497
 [82,] 0.1829405 0.1147541 0.2923977
 [83,] 0.1840629 0.1165756 0.2923977
 [84,] 0.1829405 0.1165756 0.2894737
 [85,] 0.1784512 0.1111111 0.2865497
 [86,] 0.1784512 0.1129326 0.2836257
 [87,] 0.1818182 0.1165756 0.2865497
 [88,] 0.1773288 0.1147541 0.2777778
 [89,] 0.1784512 0.1183971 0.2748538
 [90,] 0.1784512 0.1202186 0.2719298
 [91,] 0.1750842 0.1165756 0.2690058
 [92,] 0.1762065 0.1165756 0.2719298
 [93,] 0.1762065 0.1165756 0.2719298
 [94,] 0.1762065 0.1165756 0.2719298
 [95,] 0.1784512 0.1165756 0.2777778
 [96,] 0.1773288 0.1165756 0.2748538
 [97,] 0.1762065 0.1165756 0.2719298
 [98,] 0.1773288 0.1165756 0.2748538
 [99,] 0.1762065 0.1165756 0.2719298
[100,] 0.1750842 0.1147541 0.2719298
[101,] 0.1773288 0.1147541 0.2777778
[102,] 0.1762065 0.1165756 0.2719298
[103,] 0.1739618 0.1147541 0.2690058
[104,] 0.1762065 0.1165756 0.2719298
[105,] 0.1773288 0.1165756 0.2748538
[106,] 0.1739618 0.1165756 0.2660819
[107,] 0.1750842 0.1147541 0.2719298
[108,] 0.1717172 0.1147541 0.2631579
[109,] 0.1728395 0.1129326 0.2690058
[110,] 0.1728395 0.1129326 0.2690058
[111,] 0.1739618 0.1147541 0.2690058
[112,] 0.1750842 0.1147541 0.2719298
[113,] 0.1750842 0.1147541 0.2719298
[114,] 0.1739618 0.1129326 0.2719298
[115,] 0.1750842 0.1129326 0.2748538
[116,] 0.1728395 0.1111111 0.2719298
[117,] 0.1750842 0.1129326 0.2748538
[118,] 0.1750842 0.1111111 0.2777778
[119,] 0.1739618 0.1092896 0.2777778
[120,] 0.1739618 0.1111111 0.2748538
[121,] 0.1750842 0.1111111 0.2777778
[122,] 0.1762065 0.1111111 0.2807018
[123,] 0.1750842 0.1111111 0.2777778
[124,] 0.1728395 0.1092896 0.2748538
[125,] 0.1728395 0.1111111 0.2719298
[126,] 0.1717172 0.1092896 0.2719298
[127,] 0.1705948 0.1092896 0.2690058
[128,] 0.1694725 0.1092896 0.2660819
[129,] 0.1705948 0.1092896 0.2690058
[130,] 0.1750842 0.1111111 0.2777778
[131,] 0.1739618 0.1111111 0.2748538
[132,] 0.1739618 0.1111111 0.2748538
[133,] 0.1728395 0.1111111 0.2719298
[134,] 0.1728395 0.1111111 0.2719298
[135,] 0.1717172 0.1111111 0.2690058
[136,] 0.1705948 0.1111111 0.2660819
[137,] 0.1717172 0.1111111 0.2690058
[138,] 0.1705948 0.1111111 0.2660819
[139,] 0.1717172 0.1111111 0.2690058
[140,] 0.1728395 0.1129326 0.2690058
[141,] 0.1705948 0.1111111 0.2660819
[142,] 0.1705948 0.1111111 0.2660819
[143,] 0.1694725 0.1111111 0.2631579
[144,] 0.1683502 0.1111111 0.2602339
[145,] 0.1672278 0.1111111 0.2573099
[146,] 0.1705948 0.1111111 0.2660819
[147,] 0.1694725 0.1111111 0.2631579
[148,] 0.1694725 0.1129326 0.2602339
[149,] 0.1694725 0.1092896 0.2660819
[150,] 0.1705948 0.1092896 0.2690058
[151,] 0.1694725 0.1111111 0.2631579
[152,] 0.1728395 0.1129326 0.2690058
[153,] 0.1728395 0.1129326 0.2690058
[154,] 0.1728395 0.1111111 0.2719298
[155,] 0.1728395 0.1129326 0.2690058
[156,] 0.1705948 0.1111111 0.2660819
[157,] 0.1728395 0.1111111 0.2719298
[158,] 0.1705948 0.1092896 0.2690058
[159,] 0.1728395 0.1111111 0.2719298
[160,] 0.1717172 0.1092896 0.2719298
[161,] 0.1717172 0.1092896 0.2719298
[162,] 0.1717172 0.1092896 0.2719298
[163,] 0.1705948 0.1092896 0.2690058
[164,] 0.1717172 0.1111111 0.2690058
[165,] 0.1728395 0.1111111 0.2719298
[166,] 0.1739618 0.1111111 0.2748538
[167,] 0.1739618 0.1129326 0.2719298
[168,] 0.1728395 0.1111111 0.2719298
[169,] 0.1694725 0.1074681 0.2690058
[170,] 0.1705948 0.1074681 0.2719298
[171,] 0.1717172 0.1074681 0.2748538
[172,] 0.1717172 0.1092896 0.2719298
[173,] 0.1728395 0.1111111 0.2719298
[174,] 0.1750842 0.1111111 0.2777778
[175,] 0.1728395 0.1092896 0.2748538
[176,] 0.1750842 0.1111111 0.2777778
[177,] 0.1739618 0.1111111 0.2748538
[178,] 0.1728395 0.1111111 0.2719298
[179,] 0.1762065 0.1129326 0.2777778
[180,] 0.1750842 0.1111111 0.2777778
[181,] 0.1762065 0.1147541 0.2748538
[182,] 0.1750842 0.1129326 0.2748538
[183,] 0.1739618 0.1092896 0.2777778
[184,] 0.1750842 0.1111111 0.2777778
[185,] 0.1762065 0.1129326 0.2777778
[186,] 0.1750842 0.1111111 0.2777778
[187,] 0.1750842 0.1111111 0.2777778
[188,] 0.1739618 0.1111111 0.2748538
[189,] 0.1739618 0.1092896 0.2777778
[190,] 0.1750842 0.1111111 0.2777778
[191,] 0.1728395 0.1092896 0.2748538
[192,] 0.1717172 0.1092896 0.2719298
[193,] 0.1717172 0.1092896 0.2719298
[194,] 0.1717172 0.1092896 0.2719298
[195,] 0.1694725 0.1074681 0.2690058
[196,] 0.1694725 0.1056466 0.2719298
[197,] 0.1683502 0.1056466 0.2690058
[198,] 0.1694725 0.1056466 0.2719298
[199,] 0.1694725 0.1056466 0.2719298
[200,] 0.1683502 0.1056466 0.2690058
[201,] 0.1683502 0.1056466 0.2690058
[202,] 0.1694725 0.1056466 0.2719298
[203,] 0.1705948 0.1074681 0.2719298
[204,] 0.1705948 0.1092896 0.2690058
[205,] 0.1683502 0.1056466 0.2690058
[206,] 0.1705948 0.1092896 0.2690058
[207,] 0.1672278 0.1056466 0.2660819
[208,] 0.1705948 0.1092896 0.2690058
[209,] 0.1683502 0.1056466 0.2690058
[210,] 0.1705948 0.1074681 0.2719298
[211,] 0.1705948 0.1092896 0.2690058
[212,] 0.1728395 0.1092896 0.2748538
[213,] 0.1705948 0.1056466 0.2748538
[214,] 0.1728395 0.1074681 0.2777778
[215,] 0.1739618 0.1092896 0.2777778
[216,] 0.1717172 0.1074681 0.2748538
[217,] 0.1728395 0.1074681 0.2777778
[218,] 0.1717172 0.1056466 0.2777778
[219,] 0.1739618 0.1092896 0.2777778
[220,] 0.1739618 0.1092896 0.2777778
[221,] 0.1750842 0.1111111 0.2777778
[222,] 0.1762065 0.1129326 0.2777778
[223,] 0.1762065 0.1129326 0.2777778
[224,] 0.1750842 0.1111111 0.2777778
[225,] 0.1750842 0.1129326 0.2748538
[226,] 0.1750842 0.1129326 0.2748538
[227,] 0.1739618 0.1111111 0.2748538
[228,] 0.1762065 0.1129326 0.2777778
[229,] 0.1705948 0.1111111 0.2660819
[230,] 0.1694725 0.1074681 0.2690058
[231,] 0.1717172 0.1111111 0.2690058
[232,] 0.1705948 0.1092896 0.2690058
[233,] 0.1705948 0.1111111 0.2660819
[234,] 0.1705948 0.1074681 0.2719298
[235,] 0.1717172 0.1111111 0.2690058
[236,] 0.1705948 0.1092896 0.2690058
[237,] 0.1717172 0.1111111 0.2690058
[238,] 0.1705948 0.1092896 0.2690058
[239,] 0.1694725 0.1074681 0.2690058
[240,] 0.1705948 0.1092896 0.2690058
[241,] 0.1717172 0.1092896 0.2719298
[242,] 0.1717172 0.1074681 0.2748538
[243,] 0.1694725 0.1056466 0.2719298
[244,] 0.1694725 0.1056466 0.2719298
[245,] 0.1705948 0.1056466 0.2748538
[246,] 0.1717172 0.1074681 0.2748538
[247,] 0.1717172 0.1092896 0.2719298
[248,] 0.1717172 0.1074681 0.2748538
[249,] 0.1728395 0.1092896 0.2748538
[250,] 0.1728395 0.1092896 0.2748538
[251,] 0.1728395 0.1092896 0.2748538
[252,] 0.1728395 0.1092896 0.2748538
[253,] 0.1739618 0.1111111 0.2748538
[254,] 0.1728395 0.1092896 0.2748538
[255,] 0.1705948 0.1074681 0.2719298
[256,] 0.1717172 0.1074681 0.2748538
[257,] 0.1728395 0.1092896 0.2748538
[258,] 0.1739618 0.1111111 0.2748538
[259,] 0.1717172 0.1092896 0.2719298
[260,] 0.1750842 0.1129326 0.2748538
[261,] 0.1750842 0.1147541 0.2719298
[262,] 0.1750842 0.1129326 0.2748538
[263,] 0.1728395 0.1111111 0.2719298
[264,] 0.1762065 0.1129326 0.2777778
[265,] 0.1739618 0.1111111 0.2748538
[266,] 0.1728395 0.1092896 0.2748538
[267,] 0.1728395 0.1092896 0.2748538
[268,] 0.1717172 0.1092896 0.2719298
[269,] 0.1728395 0.1092896 0.2748538
[270,] 0.1728395 0.1092896 0.2748538
[271,] 0.1728395 0.1092896 0.2748538
[272,] 0.1728395 0.1092896 0.2748538
[273,] 0.1728395 0.1092896 0.2748538
[274,] 0.1728395 0.1092896 0.2748538
[275,] 0.1717172 0.1074681 0.2748538
[276,] 0.1739618 0.1111111 0.2748538
[277,] 0.1728395 0.1092896 0.2748538
[278,] 0.1728395 0.1092896 0.2748538
[279,] 0.1717172 0.1074681 0.2748538
[280,] 0.1728395 0.1092896 0.2748538
[281,] 0.1739618 0.1092896 0.2777778
[282,] 0.1739618 0.1092896 0.2777778
[283,] 0.1739618 0.1092896 0.2777778
[284,] 0.1750842 0.1111111 0.2777778
[285,] 0.1739618 0.1092896 0.2777778
[286,] 0.1773288 0.1129326 0.2807018
[287,] 0.1739618 0.1111111 0.2748538
[288,] 0.1728395 0.1092896 0.2748538
[289,] 0.1728395 0.1074681 0.2777778
[290,] 0.1717172 0.1074681 0.2748538
[291,] 0.1717172 0.1074681 0.2748538
[292,] 0.1728395 0.1092896 0.2748538
[293,] 0.1728395 0.1092896 0.2748538
[294,] 0.1717172 0.1074681 0.2748538
[295,] 0.1717172 0.1074681 0.2748538
[296,] 0.1728395 0.1092896 0.2748538
[297,] 0.1728395 0.1074681 0.2777778
[298,] 0.1762065 0.1129326 0.2777778
[299,] 0.1750842 0.1111111 0.2777778
[300,] 0.1750842 0.1111111 0.2777778
[301,] 0.1739618 0.1092896 0.2777778
[302,] 0.1728395 0.1074681 0.2777778
[303,] 0.1739618 0.1092896 0.2777778
[304,] 0.1750842 0.1111111 0.2777778
[305,] 0.1750842 0.1111111 0.2777778
[306,] 0.1728395 0.1092896 0.2748538
[307,] 0.1739618 0.1092896 0.2777778
[308,] 0.1739618 0.1092896 0.2777778
[309,] 0.1750842 0.1129326 0.2748538
[310,] 0.1762065 0.1129326 0.2777778
[311,] 0.1762065 0.1129326 0.2777778
[312,] 0.1750842 0.1129326 0.2748538
[313,] 0.1784512 0.1165756 0.2777778
[314,] 0.1750842 0.1111111 0.2777778
[315,] 0.1750842 0.1111111 0.2777778
[316,] 0.1750842 0.1129326 0.2748538
[317,] 0.1762065 0.1147541 0.2748538
[318,] 0.1762065 0.1129326 0.2777778
[319,] 0.1739618 0.1129326 0.2719298
[320,] 0.1750842 0.1129326 0.2748538
[321,] 0.1750842 0.1111111 0.2777778
[322,] 0.1739618 0.1129326 0.2719298
[323,] 0.1750842 0.1129326 0.2748538
[324,] 0.1728395 0.1129326 0.2690058
[325,] 0.1728395 0.1111111 0.2719298
[326,] 0.1728395 0.1111111 0.2719298
[327,] 0.1728395 0.1129326 0.2690058
[328,] 0.1750842 0.1129326 0.2748538
[329,] 0.1728395 0.1129326 0.2690058
[330,] 0.1728395 0.1129326 0.2690058
[331,] 0.1739618 0.1129326 0.2719298
[332,] 0.1739618 0.1129326 0.2719298
[333,] 0.1762065 0.1147541 0.2748538
[334,] 0.1762065 0.1165756 0.2719298
[335,] 0.1784512 0.1147541 0.2807018
[336,] 0.1750842 0.1147541 0.2719298
[337,] 0.1773288 0.1147541 0.2777778
[338,] 0.1762065 0.1129326 0.2777778
[339,] 0.1773288 0.1165756 0.2748538
[340,] 0.1750842 0.1147541 0.2719298
[341,] 0.1784512 0.1165756 0.2777778
[342,] 0.1739618 0.1129326 0.2719298
[343,] 0.1762065 0.1147541 0.2748538
[344,] 0.1750842 0.1147541 0.2719298
[345,] 0.1750842 0.1147541 0.2719298
[346,] 0.1750842 0.1147541 0.2719298
[347,] 0.1762065 0.1147541 0.2748538
[348,] 0.1739618 0.1147541 0.2690058
[349,] 0.1739618 0.1129326 0.2719298
[350,] 0.1739618 0.1129326 0.2719298
[351,] 0.1739618 0.1129326 0.2719298
[352,] 0.1739618 0.1129326 0.2719298
[353,] 0.1750842 0.1147541 0.2719298
[354,] 0.1739618 0.1129326 0.2719298
[355,] 0.1750842 0.1129326 0.2748538
[356,] 0.1750842 0.1129326 0.2748538
[357,] 0.1739618 0.1129326 0.2719298
[358,] 0.1750842 0.1129326 0.2748538
[359,] 0.1739618 0.1129326 0.2719298
[360,] 0.1717172 0.1092896 0.2719298
[361,] 0.1717172 0.1092896 0.2719298
[362,] 0.1717172 0.1092896 0.2719298
[363,] 0.1728395 0.1111111 0.2719298
[364,] 0.1739618 0.1129326 0.2719298
[365,] 0.1717172 0.1111111 0.2690058
[366,] 0.1728395 0.1111111 0.2719298
[367,] 0.1728395 0.1111111 0.2719298
[368,] 0.1728395 0.1111111 0.2719298
[369,] 0.1728395 0.1111111 0.2719298
[370,] 0.1728395 0.1111111 0.2719298
[371,] 0.1728395 0.1111111 0.2719298
[372,] 0.1717172 0.1092896 0.2719298
[373,] 0.1717172 0.1111111 0.2690058
[374,] 0.1728395 0.1111111 0.2719298
[375,] 0.1728395 0.1111111 0.2719298
[376,] 0.1728395 0.1111111 0.2719298
[377,] 0.1739618 0.1129326 0.2719298
[378,] 0.1717172 0.1111111 0.2690058
[379,] 0.1717172 0.1092896 0.2719298
[380,] 0.1728395 0.1092896 0.2748538
[381,] 0.1705948 0.1092896 0.2690058
[382,] 0.1705948 0.1092896 0.2690058
[383,] 0.1694725 0.1092896 0.2660819
[384,] 0.1717172 0.1111111 0.2690058
[385,] 0.1728395 0.1111111 0.2719298
[386,] 0.1717172 0.1111111 0.2690058
[387,] 0.1705948 0.1111111 0.2660819
[388,] 0.1717172 0.1111111 0.2690058
[389,] 0.1694725 0.1092896 0.2660819
[390,] 0.1717172 0.1111111 0.2690058
[391,] 0.1705948 0.1092896 0.2690058
[392,] 0.1717172 0.1111111 0.2690058
[393,] 0.1728395 0.1111111 0.2719298
[394,] 0.1717172 0.1111111 0.2690058
[395,] 0.1728395 0.1111111 0.2719298
[396,] 0.1694725 0.1092896 0.2660819
[397,] 0.1694725 0.1092896 0.2660819
[398,] 0.1705948 0.1092896 0.2690058
[399,] 0.1705948 0.1092896 0.2690058
[400,] 0.1694725 0.1092896 0.2660819
[401,] 0.1672278 0.1056466 0.2660819
[402,] 0.1683502 0.1074681 0.2660819
[403,] 0.1683502 0.1074681 0.2660819
[404,] 0.1694725 0.1074681 0.2690058
[405,] 0.1694725 0.1074681 0.2690058
[406,] 0.1694725 0.1074681 0.2690058
[407,] 0.1694725 0.1074681 0.2690058
[408,] 0.1683502 0.1074681 0.2660819
[409,] 0.1694725 0.1092896 0.2660819
[410,] 0.1694725 0.1092896 0.2660819
[411,] 0.1694725 0.1092896 0.2660819
[412,] 0.1717172 0.1111111 0.2690058
[413,] 0.1694725 0.1074681 0.2690058
[414,] 0.1705948 0.1111111 0.2660819
[415,] 0.1694725 0.1092896 0.2660819
[416,] 0.1694725 0.1092896 0.2660819
[417,] 0.1694725 0.1092896 0.2660819
[418,] 0.1717172 0.1111111 0.2690058
[419,] 0.1694725 0.1074681 0.2690058
[420,] 0.1694725 0.1074681 0.2690058
[421,] 0.1694725 0.1074681 0.2690058
[422,] 0.1694725 0.1074681 0.2690058
[423,] 0.1705948 0.1092896 0.2690058
[424,] 0.1705948 0.1092896 0.2690058
[425,] 0.1705948 0.1092896 0.2690058
[426,] 0.1694725 0.1074681 0.2690058
[427,] 0.1694725 0.1074681 0.2690058
[428,] 0.1694725 0.1074681 0.2690058
[429,] 0.1694725 0.1074681 0.2690058
[430,] 0.1694725 0.1074681 0.2690058
[431,] 0.1694725 0.1074681 0.2690058
[432,] 0.1705948 0.1092896 0.2690058
[433,] 0.1694725 0.1074681 0.2690058
[434,] 0.1694725 0.1074681 0.2690058
[435,] 0.1683502 0.1056466 0.2690058
[436,] 0.1694725 0.1074681 0.2690058
[437,] 0.1694725 0.1074681 0.2690058
[438,] 0.1694725 0.1074681 0.2690058
[439,] 0.1694725 0.1074681 0.2690058
[440,] 0.1694725 0.1074681 0.2690058
[441,] 0.1705948 0.1092896 0.2690058
[442,] 0.1717172 0.1111111 0.2690058
[443,] 0.1717172 0.1111111 0.2690058
[444,] 0.1717172 0.1111111 0.2690058
[445,] 0.1717172 0.1111111 0.2690058
[446,] 0.1717172 0.1111111 0.2690058
[447,] 0.1705948 0.1092896 0.2690058
[448,] 0.1705948 0.1092896 0.2690058
[449,] 0.1694725 0.1074681 0.2690058
[450,] 0.1694725 0.1074681 0.2690058
[451,] 0.1717172 0.1092896 0.2719298
[452,] 0.1717172 0.1092896 0.2719298
[453,] 0.1728395 0.1111111 0.2719298
[454,] 0.1717172 0.1092896 0.2719298
[455,] 0.1694725 0.1074681 0.2690058
[456,] 0.1705948 0.1092896 0.2690058
[457,] 0.1705948 0.1092896 0.2690058
[458,] 0.1717172 0.1111111 0.2690058
[459,] 0.1705948 0.1092896 0.2690058
[460,] 0.1705948 0.1092896 0.2690058
[461,] 0.1705948 0.1092896 0.2690058
[462,] 0.1705948 0.1092896 0.2690058
[463,] 0.1705948 0.1092896 0.2690058
[464,] 0.1728395 0.1129326 0.2690058
[465,] 0.1717172 0.1111111 0.2690058
[466,] 0.1717172 0.1111111 0.2690058
[467,] 0.1717172 0.1111111 0.2690058
[468,] 0.1717172 0.1111111 0.2690058
[469,] 0.1717172 0.1111111 0.2690058
[470,] 0.1717172 0.1111111 0.2690058
[471,] 0.1717172 0.1111111 0.2690058
[472,] 0.1705948 0.1111111 0.2660819
[473,] 0.1705948 0.1111111 0.2660819
[474,] 0.1683502 0.1074681 0.2660819
[475,] 0.1694725 0.1092896 0.2660819
[476,] 0.1694725 0.1092896 0.2660819
[477,] 0.1683502 0.1074681 0.2660819
[478,] 0.1694725 0.1092896 0.2660819
[479,] 0.1705948 0.1111111 0.2660819
[480,] 0.1694725 0.1092896 0.2660819
[481,] 0.1694725 0.1092896 0.2660819
[482,] 0.1705948 0.1111111 0.2660819
[483,] 0.1705948 0.1111111 0.2660819
[484,] 0.1705948 0.1111111 0.2660819
[485,] 0.1705948 0.1111111 0.2660819
[486,] 0.1705948 0.1111111 0.2660819
[487,] 0.1705948 0.1111111 0.2660819
[488,] 0.1705948 0.1111111 0.2660819
[489,] 0.1705948 0.1111111 0.2660819
[490,] 0.1705948 0.1111111 0.2660819
[491,] 0.1705948 0.1111111 0.2660819
[492,] 0.1705948 0.1111111 0.2660819
[493,] 0.1705948 0.1111111 0.2660819
[494,] 0.1705948 0.1111111 0.2660819
[495,] 0.1705948 0.1111111 0.2660819
[496,] 0.1705948 0.1111111 0.2660819
[497,] 0.1705948 0.1111111 0.2660819
[498,] 0.1705948 0.1111111 0.2660819
[499,] 0.1705948 0.1111111 0.2660819
[500,] 0.1705948 0.1111111 0.2660819
> 
> # Show model error
> plot(rf_model, ylim=c(0,0.36))
> legend('topright', colnames(rf_model$err.rate), col=1:3, fill=1:3)
> 
> # Get importance
> importance    <- importance(rf_model)
> varImportance <- data.frame(Variables = row.names(importance), 
+                             Importance = round(importance[ ,'MeanDecreaseGini'],2))
> 
> # Create a rank variable based on importance
> rankImportance <- varImportance %>%
+   mutate(Rank = paste0('#',dense_rank(desc(Importance))))
> 
> # Use ggplot2 to visualize the relative importance of variables
> ggplot(rankImportance, aes(x = reorder(Variables, Importance), 
+     y = Importance, fill = Importance)) +
+   geom_bar(stat='identity') + 
+   geom_text(aes(x = Variables, y = 0.5, label = Rank),
+     hjust=0, vjust=0.55, size = 4, colour = 'red') +
+   labs(x = 'Variables') +
+   coord_flip() + 
+   theme_few()
> 
> proc.time()
   user  system elapsed 
  0.937   0.101   1.036 
