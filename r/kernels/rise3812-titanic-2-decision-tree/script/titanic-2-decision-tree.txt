
# This R environment comes with all of CRAN preinstalled, as well as many other helpful packages
# The environment is defined by the kaggle/rstats docker image: https://github.com/kaggle/docker-rstats
# For example, here's several helpful packages to load in 

library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
library(rpart)
# library(rattle)
library(rpart.plot)
library(RColorBrewer)

# Input data files are available in the "../input/" directory.
# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory

dir("../input")

# Any results you write to the current directory are saved as output.

train <- read_csv("../input/train.csv")
test <- read_csv("../input/test.csv")
str(train)
print("---")
str(test)

my_tree <- rpart(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked, data = train, method = "class")

plot(my_tree)
text(my_tree)

rpart.plot(my_tree, type = 1, uniform = TRUE, extra = 1, under = 1, faclen = 0)

my_prediction <- predict(my_tree, newdata = test, type = "class")
my_solution <- data.frame(PassengerId = test$PassengerId, Survived = my_prediction)
nrow(my_solution)

write.csv(my_solution, file = "my_solution.csv" , row.names = FALSE)


