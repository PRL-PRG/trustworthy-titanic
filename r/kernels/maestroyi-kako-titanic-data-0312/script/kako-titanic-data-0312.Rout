
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> ## ----setup, include=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> knitr::opts_chunk$set(echo = TRUE)
> 
> 
> ## ----message=FALSE, warning=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # Data input, assement: Îç∞Ïù¥ÌÑ∞ Î°úÎìú, ÌôïÏù∏
> library(tidyverse)     # RÏùò ÌÜµÌï© Ìå®ÌÇ§ÏßÄÎ°ú Ïó¨Í∏∞ÏÑúÎäî 'readr'Ìå®ÌÇ§ÏßÄÎ•º Ïì∞Í∏∞ ÏúÑÌï®Ïù¥Îã§.
‚îÄ‚îÄ [1mAttaching packages[22m ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.0 ‚îÄ‚îÄ
[32m‚úì[39m [34mggplot2[39m 3.3.2     [32m‚úì[39m [34mpurrr  [39m 0.3.4
[32m‚úì[39m [34mtibble [39m 3.0.1     [32m‚úì[39m [34mdplyr  [39m 1.0.2
[32m‚úì[39m [34mtidyr  [39m 1.1.0     [32m‚úì[39m [34mstringr[39m 1.4.0
[32m‚úì[39m [34mreadr  [39m 1.3.1     [32m‚úì[39m [34mforcats[39m 0.5.0
‚îÄ‚îÄ [1mConflicts[22m ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
[31mx[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
[31mx[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()
Warning messages:
1: package ‚Äòggplot2‚Äô was built under R version 3.6.2 
2: package ‚Äòtibble‚Äô was built under R version 3.6.2 
3: package ‚Äòtidyr‚Äô was built under R version 3.6.2 
4: package ‚Äòpurrr‚Äô was built under R version 3.6.2 
5: package ‚Äòdplyr‚Äô was built under R version 3.6.2 
> library(descr)         # descr::CrossTable() - Î≤îÏ£ºÎ≥Ñ ÎπàÎèÑÏàò, ÎπÑÏú® ÏàòÏπòÎ°ú ÌôïÏù∏
> 
> # Visualization
> library(VIM)           #Missing values assement use by VIM::aggr()
Loading required package: colorspace
Loading required package: grid
VIM is ready to use.

Suggestions and bug-reports can be submitted at: https://github.com/statistikat/VIM/issues

Attaching package: ‚ÄòVIM‚Äô

The following object is masked from ‚Äòpackage:datasets‚Äô:

    sleep

> #library(ggplot2)      #Used in almost visualzation ÏõêÎ¨∏ÏóêÏÑ† Îî∞Î°ú Ìå®ÌÇ§ÏßÄÎ•º Î∂ÄÎ•¥ÏßÄÎßå, 
>                        #tidyverseÎÇ¥Ïóê Ìè¨Ìï®Îêú Ìå®ÌÇ§ÏßÄÎ°ú Ïó¨Í∏∞ÏÑ† Ï£ºÏÑùÏúºÎ°ú Ï≤òÎ¶¨ÌïúÎã§.
> library(RColorBrewer)  # plotÏùò color ÏÑ§Ï†ï
> library(scales)        # plot setting - x, y Ï∂ï ÏÑ§Ï†ï

Attaching package: ‚Äòscales‚Äô

The following object is masked from ‚Äòpackage:purrr‚Äô:

    discard

The following object is masked from ‚Äòpackage:readr‚Äô:

    col_factor

Warning message:
package ‚Äòscales‚Äô was built under R version 3.6.2 
> 
> # Feature Engineering, Data Pre-processing
> #library(tidyverse)    # ÏïÑÎûò Ìå®ÌÇ§ÏßÄÎäî Î™®Îëê Ìè¨Ìï®ÌïòÍ∏∞Ïóê Ï£ºÏÑù Ï≤òÎ¶¨ÌïúÎã§.
> #library(dplyr)        # Feature Engineering & Data Pre-processing
> #library(purrr)        # Check missing values
> #library(tidyr)        # tidyr::gather()
> 
> # Model generation
> library(randomForest)  # For Random Forest Modeling
randomForest 4.6-14
Type rfNews() to see new features/changes/bug fixes.

Attaching package: ‚ÄòrandomForest‚Äô

The following object is masked from ‚Äòpackage:dplyr‚Äô:

    combine

The following object is masked from ‚Äòpackage:ggplot2‚Äô:

    margin

> 
> # Model validation :   ÏõêÎ¨∏ Ïª§ÎÑêÏóêÏÑ† ÏÉùÎûµÎêú ÎÇ¥Ïö©Ïù¥Îã§.
> #library(caret)        # caret::confusionMatrix()
> #library(ROCR)         # Plotting ROC Curve
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # Multiple plot function
> #
> # ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
> # - cols:   Number of columns in layout
> # - layout: A matrix specifying the layout. If present, 'cols' is ignored.
> #
> # If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
> # then plot 1 will go in the upper left, 2 will go in the upper right, and
> # 3 will go all the way across the bottom.
> #
> 
> multiplot <- function(..., plotlist = NULL, file, cols = 1, layout = NULL) {
+   library(grid)
+   
+   # Make a list from the... arguments and plotlist
+   plots <- c(list(...), plotlist)
+   
+   numPlots = length(plots)
+   
+   # If layout is NULL< then use 'cols' to determine layout
+   if (is.null(layout)) {
+     # Make the panel
+     # ncol: number of columns of plots
+     # nrow: Number of rows needed, calculated from # of cols
+     layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
+                      ncol = cols, nrow = ceiling(numPlots/cols))
+   }
+   
+   if (numPlots==1) {
+     print(plots[[1]])
+     
+   } else {
+     # Set up the page
+     grid.newpage()
+     pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
+     
+     # Make each plot, in the correct location
+     for (i in 1:numPlots) {
+       # Get the i, j matrix positions of the regions that contain this subplot
+       matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
+       
+       print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
+                                       layout.pos.col = matchidx$col))
+     }
+   }
+  }
> 
> 
> ## ----warning=FALSE, message=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> train <- readr::read_csv("../input/train.csv")
Parsed with column specification:
cols(
  PassengerId = [32mcol_double()[39m,
  Survived = [32mcol_double()[39m,
  Pclass = [32mcol_double()[39m,
  Name = [31mcol_character()[39m,
  Sex = [31mcol_character()[39m,
  Age = [32mcol_double()[39m,
  SibSp = [32mcol_double()[39m,
  Parch = [32mcol_double()[39m,
  Ticket = [31mcol_character()[39m,
  Fare = [32mcol_double()[39m,
  Cabin = [31mcol_character()[39m,
  Embarked = [31mcol_character()[39m
)
> 
> test  <- readr::read_csv("../input/test.csv")
Parsed with column specification:
cols(
  PassengerId = [32mcol_double()[39m,
  Pclass = [32mcol_double()[39m,
  Name = [31mcol_character()[39m,
  Sex = [31mcol_character()[39m,
  Age = [32mcol_double()[39m,
  SibSp = [32mcol_double()[39m,
  Parch = [32mcol_double()[39m,
  Ticket = [31mcol_character()[39m,
  Fare = [32mcol_double()[39m,
  Cabin = [31mcol_character()[39m,
  Embarked = [31mcol_character()[39m
)
> 
> full  <- dplyr::bind_rows(train, test)
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> full <- full %>% 
+   dplyr::mutate(Survived = factor(Survived),
+                 Pclass = factor(Pclass, ordered = T),
+                 Name = factor(Name),
+                 Sex = factor(Sex),
+                 Ticket = factor(Ticket),
+                 Cabin = factor(Cabin),
+                 Embarked = factor(Embarked))
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> head(full, 10)
[90m# A tibble: 10 x 12[39m
   PassengerId Survived Pclass Name  Sex     Age SibSp Parch Ticket  Fare Cabin
         [3m[90m<dbl>[39m[23m [3m[90m<fct>[39m[23m    [3m[90m<ord>[39m[23m  [3m[90m<fct>[39m[23m [3m[90m<fct>[39m[23m [3m[90m<dbl>[39m[23m [3m[90m<dbl>[39m[23m [3m[90m<dbl>[39m[23m [3m[90m<fct>[39m[23m  [3m[90m<dbl>[39m[23m [3m[90m<fct>[39m[23m
[90m 1[39m           1 0        3      Brau‚Ä¶ male     22     1     0 A/5 2‚Ä¶  7.25 [31mNA[39m   
[90m 2[39m           2 1        1      Cumi‚Ä¶ fema‚Ä¶    38     1     0 PC 17‚Ä¶ 71.3  C85  
[90m 3[39m           3 1        3      Heik‚Ä¶ fema‚Ä¶    26     0     0 STON/‚Ä¶  7.92 [31mNA[39m   
[90m 4[39m           4 1        1      Futr‚Ä¶ fema‚Ä¶    35     1     0 113803 53.1  C123 
[90m 5[39m           5 0        3      Alle‚Ä¶ male     35     0     0 373450  8.05 [31mNA[39m   
[90m 6[39m           6 0        3      Mora‚Ä¶ male     [31mNA[39m     0     0 330877  8.46 [31mNA[39m   
[90m 7[39m           7 0        1      McCa‚Ä¶ male     54     0     0 17463  51.9  E46  
[90m 8[39m           8 0        3      Pals‚Ä¶ male      2     3     1 349909 21.1  [31mNA[39m   
[90m 9[39m           9 1        3      John‚Ä¶ fema‚Ä¶    27     0     2 347742 11.1  [31mNA[39m   
[90m10[39m          10 1        2      Nass‚Ä¶ fema‚Ä¶    14     1     0 237736 30.1  [31mNA[39m   
[90m# ‚Ä¶ with 1 more variable: Embarked [3m[90m<fct>[90m[23m[39m
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> str(full)
tibble [1,309 √ó 12] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ PassengerId: num [1:1309] 1 2 3 4 5 6 7 8 9 10 ...
 $ Survived   : Factor w/ 2 levels "0","1": 1 2 2 2 1 1 1 1 2 2 ...
 $ Pclass     : Ord.factor w/ 3 levels "1"<"2"<"3": 3 1 3 1 3 3 1 3 3 2 ...
 $ Name       : Factor w/ 1307 levels "Abbing, Mr. Anthony",..: 156 287 531 430 23 826 775 922 613 855 ...
 $ Sex        : Factor w/ 2 levels "female","male": 2 1 1 1 2 2 2 2 1 1 ...
 $ Age        : num [1:1309] 22 38 26 35 35 NA 54 2 27 14 ...
 $ SibSp      : num [1:1309] 1 1 0 1 0 0 0 3 0 1 ...
 $ Parch      : num [1:1309] 0 0 0 0 0 0 0 1 2 0 ...
 $ Ticket     : Factor w/ 929 levels "110152","110413",..: 721 817 915 66 650 374 110 542 478 175 ...
 $ Fare       : num [1:1309] 7.25 71.28 7.92 53.1 8.05 ...
 $ Cabin      : Factor w/ 186 levels "A10","A11","A14",..: NA 107 NA 71 NA NA 164 NA NA NA ...
 $ Embarked   : Factor w/ 3 levels "C","Q","S": 3 1 3 3 3 2 3 3 3 1 ...
 - attr(*, "spec")=
  .. cols(
  ..   PassengerId = [32mcol_double()[39m,
  ..   Survived = [32mcol_double()[39m,
  ..   Pclass = [32mcol_double()[39m,
  ..   Name = [31mcol_character()[39m,
  ..   Sex = [31mcol_character()[39m,
  ..   Age = [32mcol_double()[39m,
  ..   SibSp = [32mcol_double()[39m,
  ..   Parch = [32mcol_double()[39m,
  ..   Ticket = [31mcol_character()[39m,
  ..   Fare = [32mcol_double()[39m,
  ..   Cabin = [31mcol_character()[39m,
  ..   Embarked = [31mcol_character()[39m
  .. )
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> summary(full)
  PassengerId   Survived   Pclass                                Name     
 Min.   :   1   0   :549   1:323   Connolly, Miss. Kate            :   2  
 1st Qu.: 328   1   :342   2:277   Kelly, Mr. James                :   2  
 Median : 655   NA's:418   3:709   Abbing, Mr. Anthony             :   1  
 Mean   : 655                      Abbott, Master. Eugene Joseph   :   1  
 3rd Qu.: 982                      Abbott, Mr. Rossmore Edward     :   1  
 Max.   :1309                      Abbott, Mrs. Stanton (Rosa Hunt):   1  
                                   (Other)                         :1301  
     Sex           Age            SibSp            Parch            Ticket    
 female:466   Min.   : 0.17   Min.   :0.0000   Min.   :0.000   CA. 2343:  11  
 male  :843   1st Qu.:21.00   1st Qu.:0.0000   1st Qu.:0.000   1601    :   8  
              Median :28.00   Median :0.0000   Median :0.000   CA 2144 :   8  
              Mean   :29.88   Mean   :0.4989   Mean   :0.385   3101295 :   7  
              3rd Qu.:39.00   3rd Qu.:1.0000   3rd Qu.:0.000   347077  :   7  
              Max.   :80.00   Max.   :8.0000   Max.   :9.000   347082  :   7  
              NA's   :263                                      (Other) :1261  
      Fare                     Cabin      Embarked  
 Min.   :  0.000   C23 C25 C27    :   6   C   :270  
 1st Qu.:  7.896   B57 B59 B63 B66:   5   Q   :123  
 Median : 14.454   G6             :   5   S   :914  
 Mean   : 33.295   B96 B98        :   4   NA's:  2  
 3rd Qu.: 31.275   C22 C26        :   4             
 Max.   :512.329   (Other)        : 271             
 NA's   :1         NA's           :1014             
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> VIM::aggr(full, prop = FALSE, combined = TRUE, numbers = TRUE, 
+           sortVars = TRUE, sortCombs = TRUE)

 Variables sorted by number of missings: 
    Variable Count
       Cabin  1014
    Survived   418
         Age   263
    Embarked     2
        Fare     1
 PassengerId     0
      Pclass     0
        Name     0
         Sex     0
       SibSp     0
       Parch     0
      Ticket     0
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> full %>% 
+   dplyr::summarise_all(funs(sum(is.na(.))/n()))
[90m# A tibble: 1 x 12[39m
  PassengerId Survived Pclass  Name   Sex   Age SibSp Parch Ticket    Fare Cabin
        [3m[90m<dbl>[39m[23m    [3m[90m<dbl>[39m[23m  [3m[90m<dbl>[39m[23m [3m[90m<dbl>[39m[23m [3m[90m<dbl>[39m[23m [3m[90m<dbl>[39m[23m [3m[90m<dbl>[39m[23m [3m[90m<dbl>[39m[23m  [3m[90m<dbl>[39m[23m   [3m[90m<dbl>[39m[23m [3m[90m<dbl>[39m[23m
[90m1[39m           0    0.319      0     0     0 0.201     0     0      0 7.64[90me[39m[31m-4[39m 0.775
[90m# ‚Ä¶ with 1 more variable: Embarked [3m[90m<dbl>[90m[23m[39m
Warning message:
`funs()` is deprecated as of dplyr 0.8.0.
Please use a list of either functions or lambdas: 

  # Simple named list: 
  list(mean = mean, median = median)

  # Auto named with `tibble::lst()`: 
  tibble::lst(mean, median)

  # Using lambdas
  list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
[90mThis warning is displayed once every 8 hours.[39m
[90mCall `lifecycle::last_warnings()` to see where this warning was generated.[39m 
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # Í∞Å featureÏùò Í≤∞Ï∏°Ïπò ÎπÑÏú® Í≥ÑÏÇ∞ -> Data Frame ÏÜçÏÑ± but 1Ìñâ 12Ïó¥ Íµ¨Ï°∞Î°ú ÎêòÏñ¥ÏûàÎã§.
> missing_values <- full %>% 
+   dplyr::summarise_all(funs(sum(is.na(.))/n()))
> 
> # ÏúÑÏóêÏÑú Íµ¨Ìïú missing_valuesÎ•º 12x2 data frameÏúºÎ°ú ÏÉùÏÑ±
> missing_values <- tidyr::gather(missing_values,
+                                 key = 'feature', value = 'missing_pct')
> 
> # missing_valuesÎ•º ÌôúÏö©Ìïú ÏãúÍ∞ÅÌôî
> missing_values %>% 
+   # Aesthetic setting: missing_pct ÎÇ¥Î¶ºÏ∞®ÏàúÏúºÎ°ú Ï†ïÎ†¨
+   ggplot(aes(x = reorder(feature, missing_pct), y = missing_pct)) +
+   # Bar plot
+   geom_bar(stat = 'identity', fill = 'red') +
+   # Title generation
+   ggtitle('Rate of missing values in each features') +
+   # Title detail setting
+   theme(plot.title = element_text(face = 'bold',    #Í∏ÄÏî®Ï≤¥
+                                   hjust = 0.5,       # Horizon(Í∞ÄÎ°úÎπÑÏú®) 
+                                   size = 15, 
+                                   color = 'darkblue')) +
+   # x, y axis label setting
+   labs(x = 'Feature names', y = 'Rate') + 
+   # PlotÏùò x, y Ï∂ï Î≥ÄÌôò
+   coord_flip()
> 
> 
> ## ----message=FALSE, warning=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> age.p1 <- full %>% 
+   ggplot(aes(Age)) +
+   # ÌûàÏä§ÌÜ†Í∑∏Îû® ÏûëÏÑ±, ÏÑ§Ï†ï
+   geom_histogram(breaks = seq(0, 80, by = 1), #Í∞ÑÍ≤© ÏÑ§Ï†ï
+                  col = 'red',     # ÎßâÎåÄ Í≤ΩÍ≥ÑÏÑ† ÏÉâÍπî
+                  fill = 'green',  # ÎßâÎåÄ Ï±ÑÏö∞Í∏∞ ÏÉâÍπî
+                  alpha = .5) +     # ÎßâÎåÄ Ìà¨Î™ÖÎèÑ 50%
+   # Plot title
+   ggtitle('All Titanic passengers age histogram') +
+   theme(plot.title = element_text(face = 'bold',   #Í∏ÄÏî®Ï≤¥
+                                     hjust = 0.5,  #Horizon(Í∞ÄÎ°úÎπÑÏú®)
+                                     size = 15,
+                                     color = 'darkblue'))
>   
> age.p2 <- full %>% 
+   # test data setÏùò Survived == NA Ïù∏ Í∞íÎì§ Ï†úÏô∏
+   filter(!is.na(Survived)) %>% 
+   ggplot(aes(Age, fill = Survived)) +
+   geom_density(alpha = .5) +
+   ggtitle('Titanic passengers age density plot') +
+   theme(plot.title = element_text(face = 'bold', hjust = 0.5,
+                                   size = 15, color = 'darkblue'))
>   
>   # multiplot layout ÌòïÏãù ÏßÄÏ†ï
>   multi.layout = matrix(c(1, 1, 2, 2), 2, 2, byrow = T)
>   
>   # ÏúÑÏóêÏÑú ÏÉùÏÑ±Ìïú 2Í∞úÏùò Í∑∏ÎûòÌîÑÎ•º Ìïú ÌôîÎ©¥Ïóê Ï∂ïÎ†•
>   multiplot(age.p1, age.p2, layout = multi.layout)
Warning messages:
1: Removed 263 rows containing non-finite values (stat_bin). 
2: Removed 177 rows containing non-finite values (stat_density). 
> 
> 
> ## ----message=FALSE, warning=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> full %>% 
+   # dplyr::group_by(), summarize() Î•º Ïù¥Ïö©Ìï¥ÏÑú Pclass ÎπàÎèÑÏàò Íµ¨ÌïòÍ∏∞
+   group_by(Pclass) %>% 
+   summarize(N = n()) %>% 
+   # Aesthetic setting
+   ggplot(aes(Pclass, N)) +
+   geom_col() +
+   # Pclass ÎπàÎèÑÏàò plotÏóê Ï∂úÎ†•
+   geom_text(aes(label = N),  #PlotÏùò yÏóê Ìï¥ÎãπÌïòÎäî N(ÎπàÎèÑÏàò) Îß§Ìïë
+             size = 5,   #Í∏ÄÏî® ÌÅ¨Í∏∞
+             vjust = 1.2,  #Vertical(Í∞ÄÎ°ú) ÏúÑÏπò ÏÑ§Ï†ï
+             color = '#FFFFFF') +   #Í∏ÄÏî® ÏÉâÍπî : Ìù∞ÏÉâ
+   # Plot title
+   ggtitle("Number of each Pclass's passenger") +
+   # Title setting
+   theme(plot.title = element_text(face = 'bold', hjust = 0.5, size = 15)) +
+   # x, y axis name change
+   labs(x = 'Pclass', y = 'Count')
`summarise()` ungrouping output (override with `.groups` argument)
> 
> 
> ## ----message=FALSE, warning=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
>   # Histogram
>   Fare.p1 <- full %>% 
+     ggplot(aes(Fare)) +
+     geom_histogram(col = 'yellow',
+                    fill = 'blue',
+                    alpha = .5) +
+   ggtitle('Histogram of passengers Fare') +
+   theme(plot.title = element_text(face = 'bold', hjust = 0.5, size = 15))
> 
>   # Boxplot
>   Fare.p2 <- full %>% 
+     filter(!is.na(Survived)) %>% 
+     ggplot(aes(Survived, Fare)) +
+     # Í¥ÄÏ∏°ÏπòÎäî ÌöåÏÉâÏ†ê, Ï§ëÎ≥µÎêòÎäî Î∂ÄÎ∂ÑÏùÄ Ìù©ÎøåÎ†§ÏÑú ÎÇòÌÉÄÎÉÑ
+     geom_jitter(col='gray') +
+     # boxplot : xnaudeh 50%
+     geom_boxplot(alpha = .5) +
+     ggtitle('Boxplot of passengers Fare') +
+     theme(plot.title = element_text(face = 'bold', hjust = 0.5, size= 15))
>   
>   # multiplot layout ÌòïÏãù ÏßÄÏ†ï
>   mulit.layout = matrix(c(1, 1, 2, 2), 2, 2)
>   
>   # ÏúÑÏóêÏÑú ÏÉùÏÑ±Ìïú 2Í∞ú Í∑∏ÎûòÌîÑÎ•º Ìïú ÌôîÎ©¥Ïóê Ï∂úÎ†•
>   multiplot(Fare.p1, Fare.p2, layout = multi.layout)
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Warning message:
Removed 1 rows containing non-finite values (stat_bin). 
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> sex.p1 <- full %>% 
+   dplyr::group_by(Sex) %>% 
+   summarize(N = n()) %>% 
+   ggplot(aes(Sex, N)) +
+   geom_col() +
+   geom_text(aes(label = N), size = 5, vjust = 1.2, color = "#FFFFFF") + 
+   ggtitle("Bar plot of Sex") +
+   labs(x = "Sex", y = "Count")
`summarise()` ungrouping output (override with `.groups` argument)
> 
> sex.p2 <- full[1:891, ] %>% # 892Ìñâ Ïù¥ÌõÑÎ∂ÄÌÑ∞Îäî 'test' dataÎ°ú ÏÉùÏ°¥Ïú®Ïù¥ NAÍ∞íÏûÑ.
+   ggplot(aes(Sex, fill = Survived)) +
+   geom_bar(position = 'fill') +
+   scale_fill_brewer(palette = "Set1") +
+   scale_y_continuous(labels = percent) +
+   ggtitle('Survival Rate by Sex') +
+   labs(x = 'Sex', y = 'Rate')
> 
> multi.layout = matrix(rep(c(1, 2), times = 2), 2, 2, byrow = T)
> 
> multiplot(sex.p1, sex.p2, layout = multi.layout)
> 
> mosaicplot(Survived ~ Sex,
+            data = full[1:891, ], col = TRUE,
+            main = 'Survival rate by passengers gender')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> full <- full %>%
+   # Í≤∞Ï∏°Ïπò Ï†úÏô∏Ìïú Í∞íÎì§Ïùò ÌèâÍ∑†ÏúºÎ°ú Í≤∞Ï∏°ÏπòÎ•º Ï±ÑÏõÄ
+   mutate(Age = ifelse(is.na(Age), mean(full$Age, na.rm = TRUE), Age),
+          # Age Í∞íÏóê Îî∞Îùº Î≤îÏ£ºÌòï ÌååÏÉù Î≥ÄÏàò Age.Group ÏÉùÏÑ±)
+          Age.Group = case_when(Age < 13 ~ 'Age.0012',
+                                Age >= 13 & Age < 18 ~ 'Age.1317',
+                                Age >= 18 & Age < 60 ~ 'Age.1859',
+                                Age >= 60 ~ 'Age.60inf'),
+          # Chr ÏÜçÏÑ±ÏùÑ FactorÎ°ú Î≥ÄÌôò
+          Age.Group = factor(Age.Group))
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> full <- full %>% 
+   # SibSp, ParchÏôÄ 1(Î≥∏Ïù∏)ÏùÑ ÎçîÌï¥ÏÑú FamilySizeÎùºÎäî ÌååÏÉùÎ≥ÄÏàòÎ•º Î®ºÏ†Ä ÏÉùÏÑ±
+   mutate(FamilySize = .$SibSp + .$Parch + 1,
+          # FamilySize Ïùò Í∞íÏóê Îî∞ÎùºÏÑú Î≤îÏ£ºÌòï ÌååÏÉù Î≥ÄÏàò FamilySizedÎ•º ÏÉùÏÑ±
+          FamilySized = dplyr::case_when(FamilySize == 1 ~ "Single",
+                                         FamilySize >= 2 & FamilySize < 5 ~ "Small",
+                                         FamilySize >= 5 ~ "Big"),
+          # Chr ÏÜçÏÑ±Ïù∏ FamilySizedÎ•º factorÎ°ú Î≥ÄÌôò
+          # ÏßëÎã® Í∑úÎ™® ÌÅ¨Í∏∞Ïóê Îî∞Îùº levelsÎ•º ÏÉàÎ°ú ÏßÄÏ†ï
+          FamilySized = factor(FamilySized, levels = c("Single", "Small", "Big")))
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # Name Ïó¥ Ï∂îÏ∂ú
> title <- full$Name
> 
> # Ï†ïÍ∑úÌëúÌòÑÏãùÍ≥º gsub()ÏùÑ Ïù¥ÏöîÌï¥ÏÑú ÏÑ±Î≥ÑÍ≥º Í¥ÄÎ†®ÏÑ±Ïù¥ ÎÜíÏùÄ Ïù¥Î¶ÑÎßå Ï∂îÏ∂úÌï¥ÏÑú title Î≤°ÌÑ∞Î°ú Ï†ÄÏû•
> title <- gsub("^.*, (.*?)\\..*$", "\\1", title)
> 
> # ÏúÑÏóêÏÑú Ï†ÄÏû•Ìïú title Î≤°ÌÑ∞Î•º fullÏóê ÌååÏÉùÎ≥ÄÏàòÎ°ú Ï†ÄÏû•
> full$title <- title
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> unique(full$title)
 [1] "Mr"           "Mrs"          "Miss"         "Master"       "Don"         
 [6] "Rev"          "Dr"           "Mme"          "Ms"           "Major"       
[11] "Lady"         "Sir"          "Mlle"         "Col"          "Capt"        
[16] "the Countess" "Jonkheer"     "Dona"        
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # Î≤îÏ£ºÎ≥Ñ ÎπàÎèÑÏàò, ÎπÑÏú® ÌôïÏù∏
> descr::CrossTable(full$title)
   Cell Contents 
|-------------------------|
|                       N | 
|           N / Row Total | 
|-------------------------|

|         Capt |          Col |          Don |         Dona |           Dr |
|--------------|--------------|--------------|--------------|--------------|
|            1 |            4 |            1 |            1 |            8 |
|        0.001 |        0.003 |        0.001 |        0.001 |        0.006 |
|--------------|--------------|--------------|--------------|--------------|

|     Jonkheer |         Lady |        Major |       Master |         Miss |
|--------------|--------------|--------------|--------------|--------------|
|            1 |            1 |            2 |           61 |          260 |
|        0.001 |        0.001 |        0.002 |        0.047 |        0.199 |
|--------------|--------------|--------------|--------------|--------------|

|         Mlle |          Mme |           Mr |          Mrs |           Ms |
|--------------|--------------|--------------|--------------|--------------|
|            2 |            1 |          757 |          197 |            2 |
|        0.002 |        0.001 |        0.578 |        0.150 |        0.002 |
|--------------|--------------|--------------|--------------|--------------|

|          Rev |          Sir | the Countess |
|--------------|--------------|--------------|
|            8 |            1 |            1 |
|        0.006 |        0.001 |        0.001 |
|--------------|--------------|--------------|

> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # 5Í∞ú Î≤îÏ£ºÎ°ú Îã®ÏàúÌôî
> full <- full %>% 
+   # '%in%' ÎåÄÏã† '=='ÏùÑ Ïì∏ Ïãú Recycling Rule ÎïåÎ¨∏Ïóê ÏõêÌïòÎäîÎåÄÎ°ú ÎêòÏßÄ ÏïäÏùå.
+   mutate(title = ifelse(title %in% c('Mlle', 'Ms', 'Lady', 'Dona'), 'Miss', title),
+          title = ifelse(title == 'Mme', 'Mrs', title),
+          title = ifelse(title %in% c('Capt', "col",'Major', 'Dr', 'Rev', 'Don',
+                                      'Sir', "the Countess", 'Jonkheer'), "officer", title),
+          title = factor(title))
> 
> # ÌååÏÉùÎ≥ÄÏàò ÏÉùÏÑ± ÌõÑ Í∞Å Î≤îÏ£ºÎ≥Ñ ÎπàÎèÑÏàò, ÎπÑÏú® ÌôïÏù∏
> descr::CrossTable(full$title)
   Cell Contents 
|-------------------------|
|                       N | 
|           N / Row Total | 
|-------------------------|

|     Col |  Master |    Miss |      Mr |     Mrs | officer |
|---------|---------|---------|---------|---------|---------|
|       4 |      61 |     266 |     757 |     198 |      23 |
|   0.003 |   0.047 |   0.203 |   0.578 |   0.151 |   0.018 |
|---------|---------|---------|---------|---------|---------|

> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # 'unique'Ìïú Î≤îÏ£ºÏùò Í∞ØÏàòÎßå ÌååÏïÖÌïòÎ†§Í≥† length()Î•º ÏÇ¨Ïö©
> length(unique(full$Ticket))
[1] 929
> 
> # Î™®Îëê Ï∂úÎ†•ÌïòÎ©¥ ÏßÄÏ†ÄÎ∂ÑÌïòÎãà 10Í∞úÎßå Ï∂úÎ†•
> head(summary(full$Ticket), 10)
    CA. 2343         1601      CA 2144      3101295       347077       347082 
          11            8            8            7            7            7 
    PC 17608 S.O.C. 14879       113781        19950 
           7            7            6            6 
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> full %>% 
+   # Ìã∞ÏºìÏù¥ ÏùºÏπòÌïòÎäî 11Î™ÖÏùò ÏäπÍ∞ùÎì§ ÌïÑÌÑ∞ÎßÅ
+   filter(Ticket == 'CA. 2343') %>% 
+   # Î™á Í∞ÄÏßÄ Î≥ÄÏàò ÌôïÏù∏
+   select(Pclass, Name, Age, FamilySized)
[90m# A tibble: 11 x 4[39m
   Pclass Name                                    Age FamilySized
   [3m[90m<ord>[39m[23m  [3m[90m<fct>[39m[23m                                 [3m[90m<dbl>[39m[23m [3m[90m<fct>[39m[23m      
[90m 1[39m 3      [90m"[39mSage, Master. Thomas Henry[90m"[39m           29.9 Big        
[90m 2[39m 3      [90m"[39mSage, Miss. Constance Gladys[90m"[39m         29.9 Big        
[90m 3[39m 3      [90m"[39mSage, Mr. Frederick[90m"[39m                  29.9 Big        
[90m 4[39m 3      [90m"[39mSage, Mr. George John Jr[90m"[39m             29.9 Big        
[90m 5[39m 3      [90m"[39mSage, Miss. Stella Anna[90m"[39m              29.9 Big        
[90m 6[39m 3      [90m"[39mSage, Mr. Douglas Bullen[90m"[39m             29.9 Big        
[90m 7[39m 3      [90m"[39mSage, Miss. Dorothy Edith \"Dolly\"[90m"[39m  29.9 Big        
[90m 8[39m 3      [90m"[39mSage, Miss. Ada[90m"[39m                      29.9 Big        
[90m 9[39m 3      [90m"[39mSage, Mr. John George[90m"[39m                29.9 Big        
[90m10[39m 3      [90m"[39mSage, Master. William Henry[90m"[39m          14.5 Big        
[90m11[39m 3      [90m"[39mSage, Mrs. John (Annie Bullen)[90m"[39m       29.9 Big        
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # ticket.uniqueÍ∞Ä Î™®Îëê 0Ïù¥ÎùºÍ≥† Ï†ÄÏû•
> ticket.unique <- rep(0, nrow(full))
> 
> # Ticket FeatureÏóêÏÑú uniqueÌïú Í≤ÉÎì§Îßå Ï∂îÏ∂úÌï¥ÏÑú tickets Î≤°ÌÑ∞Ïóê Ï†ÄÏû•
> tickets <- unique(full$Ticket)
> 
> # Î∞òÎ≥µÎ¨∏ÏùÑ Ï§ëÏ≤© ÌôúÏö©Ìï¥ÏÑú Ìã∞ÏºìÏù¥ Í∞ôÏùÄ ÏäπÍ∞ùÎì§Îßå ÏÑ†Î≥Ñ ÌõÑ, Í∞Å Ìã∞ÏºìÏùò Í∏∏Ïù¥Î•º Ï∂îÏ∂úÌïòÏó¨ Ï†ÄÏû•
> for (i in 1:length(tickets)) {
+   current.ticket <- tickets[i]
+   party.indexes <- which(full$Ticket == current.ticket)
+     # For loop Ï§ëÏ≤©
+     for (k in 1:length(party.indexes)) {
+       ticket.unique[party.indexes[k]] <- length(party.indexes)
+     }
+   }
> 
> # ÏúÑÏóêÏÑú Í≥ÑÏÇ∞Ìïú ticket.uniqueÎ•º ÌååÏÉùÎ≥ÄÏàòÎ°ú Ï†ÄÏû•
> full$ticket.unique <- ticket.unique
> 
> # ticket.uniqueÏóê Îî∞Îùº ÏÑ∏Í∞ÄÏßÄ Î≤îÏ£ºÎ°ú ÎÇòÎà†ÏÑú ticket.size Î≥ÄÏàò ÏÉùÏÑ±
> full <- full %>% 
+   mutate(ticket.size = case_when(ticket.unique == 1 ~ 'Single',
+                                  ticket.unique < 5 & ticket.unique >= 2 ~ 'Small',
+                                  ticket.unique >= 5 ~ 'Big'),
+          ticket.size = factor(ticket.size, 
+                               levels = c('Single','Small','Big')))
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> full$Embarked <- replace(full$Embarked,               # ÏπòÌôòÌï† Data$feature ÏßÄÏ†ï
+                          which(is.na(full$Embarked)), # Í≤∞Ï∏°Ïπò Ï∞æÍ∏∞
+                          'S')                         # ÏπòÌôòÌï† Í∞í ÏßÄÏ†ï
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> full$Fare <- replace(full$Fare, which(is.na(full$Fare)), 0)
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # feature selection Ï†ÑÏù¥ÎØÄÎ°ú Î™®Îì† Î≥ÄÏàòÎì§ÏùÑ ÏÑ†ÌÉù
> train <- full[1:891, ]
> 
> test <- full[892:1309, ]
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> train %>% 
+   ggplot(aes(Pclass, fill = Survived)) +
+   geom_bar(position = 'fill') +
+   # plot ÌÖåÎßà ÏÑ§Ï†ï : Ï°∞Í∏à Îçî ÏÑ†Î™ÖÌïú ÏÉâÍπîÎ°ú Î≥ÄÌôò
+   scale_fill_brewer(palette = 'Set1')  +
+   # Y axis setting
+   scale_y_continuous(labels = percent) +
+   # x, y Ï∂ï Ïù¥Î¶ÑÍ≥º plotÏùò main title, sub title ÏÑ§Ï†ï
+   labs(x = 'Pclass', y = "Rate",
+        title = "Bar plot", subtitle = 'How many people survived in each Pclass?')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> mosaicplot(Survived ~ Sex,
+            data = train, col = TRUE,
+            main = 'Survival rate by passengers gender')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> train %>% 
+   ggplot(aes(Embarked, fill = Survived)) +
+   geom_bar(position = 'fill') +
+   scale_fill_brewer(palette = 'Set1') +
+   scale_y_continuous(labels = percent) +
+   labs(x = 'Embarked', y = 'Rate',
+        title = 'Bar plot', subtitle = 'How many people survied in each Embarked?')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> train %>% 
+   ggplot(aes(FamilySized, fill = Survived)) + 
+   geom_bar(position = 'fill') +
+   scale_fill_brewer(palette = 'Set1') +
+   scale_y_continuous(labels = percent) +
+   labs(x = "FamilySized", y = 'Rate',
+        title = 'Bar plot', subtitle = 'Survival rate by FamilySized')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> train %>% 
+   ggplot(aes(Age.Group, fill = Survived)) +
+   geom_bar(position = 'fill') +
+   scale_fill_brewer(palette = 'Set1') +
+   scale_y_continuous(labels = percent) +
+   labs(x = 'Age group', y = 'Rate',
+        title = 'Bar plot', subtitle = 'Survivla rate by Age group')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> train %>% 
+   ggplot(aes(title, fill = Survived)) +
+   geom_bar(position = 'fill') +
+   scale_fill_brewer(palette = 'Set1') +
+   scale_y_continuous(labels = percent) + 
+   labs(x = 'title', y = 'Rate',
+        title = 'Bar plot', subtitle = 'Survival rate by passengers title')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> train %>% 
+   ggplot(aes(ticket.size, fill = Survived)) +
+   geom_bar(position = 'fill') + 
+   scale_fill_brewer(palette = 'Set1') + 
+   scale_y_continuous(labels = percent) +
+   labs(x = 'ticket.size', y = 'Rate',
+        title = 'Bar plot', subtitle = 'Survival rate by ticket.size')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # Id number Ï†úÏô∏ÌïòÍ≥† Ïã§Ï†úÎ°ú ÏÇ¨Ïö©Ìï† 7Í∞ú ÏûÖÎ†• Î≥ÄÏàòÏôÄ 1Í∞ú ÌÉÄÍ≤ü Î≥ÄÏàòÎ•º ÏÑ†ÌÉù, Ï†ÄÏû•
> train <- train %>% 
+   select('Pclass', 'Sex', 'Embarked', 'FamilySized', 'Age.Group', 'title',
+          'ticket.size', 'Survived')
> 
> # SubmitÏùÑ ÏúÑÌï¥ Id Ïó¥ Ï∂îÏ∂úÌïòÏó¨ IDÏóê Ï†ÄÏû•
> ID <- test$PassengerId
> 
> # IdÏôÄ SurvivedÎ•º Ï†úÏô∏Ìïú ÎÇòÎ®∏ÏßÄ 6Í∞ú Î≥ÄÏàò ÏÑ†ÌÉù, Ï†ÄÏû•
> test <- test %>% 
+   select('Pclass', 'Sex', 'Embarked', 'FamilySized', 'Age.Group','title','ticket.size')
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # Ïû¨ÌòÑÏÑ±ÏùÑ ÏúÑÌï¥ seed numberÎ•º ÏÑ§Ï†ï
> set.seed(1901)
> 
> titanic.rf <- randomForest(Survived ~ ., data = train, importance = T, ntree = 2000)
> 
> 
> ## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> importance(titanic.rf)
                    0        1 MeanDecreaseAccuracy MeanDecreaseGini
Pclass      48.064732 55.31568             67.28920        37.485941
Sex         51.578437 35.25159             55.65668        52.964241
Embarked    -6.508585 34.61697             25.25949         9.178969
FamilySized 32.340175 30.32503             49.78611        17.975488
Age.Group   13.612591 26.62673             27.85438        10.103775
title       49.855871 43.81056             59.36445        77.800504
ticket.size 40.067927 39.48394             61.32680        22.520265
> 
> varImpPlot(titanic.rf)
> 
> 
> ## ----eval=FALSE------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> ## # Prediction
> ## pred.rf <- predict(object = titanic.rf, newdata = test, type = "class")
> ## 
> ## # Data frame generation
> ## submit <-  data.frame(PassengerID = ID, Survived = pred.rf)
> ## 
> ## # Write the submit data frame to file: setwd()Î°ú ÏßÄÏ†ïÌï¥ÎÜìÏùÄ Ìè¥ÎçîÏóê csvÎ°ú ÏÉùÏÑ±Îê®.
> ## write.csv(submit, file = './titanic_submit.csv', row.names = F)
> 
> 
> proc.time()
   user  system elapsed 
  6.308   0.289   6.667 
