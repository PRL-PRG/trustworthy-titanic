
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> 
> ## Importing packages
> 
> # This R environment comes with all of CRAN and many other helpful packages preinstalled.
> # You can see which packages are installed by checking out the kaggle/rstats docker image: 
> # https://github.com/kaggle/docker-rstats
> 
> library(tidyverse) # metapackage with lots of helpful functions
â”€â”€ [1mAttaching packages[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.3.0 â”€â”€
[32mâœ“[39m [34mggplot2[39m 3.3.2     [32mâœ“[39m [34mpurrr  [39m 0.3.4
[32mâœ“[39m [34mtibble [39m 3.0.1     [32mâœ“[39m [34mdplyr  [39m 1.0.2
[32mâœ“[39m [34mtidyr  [39m 1.1.0     [32mâœ“[39m [34mstringr[39m 1.4.0
[32mâœ“[39m [34mreadr  [39m 1.3.1     [32mâœ“[39m [34mforcats[39m 0.5.0
â”€â”€ [1mConflicts[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
[31mx[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
[31mx[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()
Warning messages:
1: package â€˜ggplot2â€™ was built under R version 3.6.2 
2: package â€˜tibbleâ€™ was built under R version 3.6.2 
3: package â€˜tidyrâ€™ was built under R version 3.6.2 
4: package â€˜purrrâ€™ was built under R version 3.6.2 
5: package â€˜dplyrâ€™ was built under R version 3.6.2 
> 
> ## Running code
> 
> # In a notebook, you can run a single code cell by clicking in the cell and then hitting 
> # the blue arrow to the left, or by clicking in the cell and pressing Shift+Enter. In a script, 
> # you can run code by highlighting the code you want to run and then clicking the blue arrow
> # at the bottom of this window.
> 
> ## Reading in files
> 
> # You can access files from datasets you've added to this kernel in the "../input/" directory.
> # You can see the files added to this kernel by running the code below. 
> 
> list.files(path = "../input")
[1] "gender_submission.csv" "test.csv"              "train.csv"            
> 
> ## Saving data
> 
> # If you save any files or images, these will be put in the "output" directory. You 
> # can see the output directory by committing and running your kernel (using the 
> # Commit & Run button) and then checking out the compiled version of your kernel.
> 
> titanic_test<- read.delim("../input/test.csv", header = T, sep = ",", stringsAsFactors = T)
> str(titanic_test)
'data.frame':	418 obs. of  11 variables:
 $ PassengerId: int  892 893 894 895 896 897 898 899 900 901 ...
 $ Pclass     : int  3 3 2 3 3 3 3 2 3 3 ...
 $ Name       : Factor w/ 418 levels "Abbott, Master. Eugene Joseph",..: 210 409 273 414 182 370 85 58 5 104 ...
 $ Sex        : Factor w/ 2 levels "female","male": 2 1 2 2 1 2 1 2 1 2 ...
 $ Age        : num  34.5 47 62 27 22 14 30 26 18 21 ...
 $ SibSp      : int  0 1 0 0 1 0 0 1 0 2 ...
 $ Parch      : int  0 0 0 0 1 0 0 1 0 0 ...
 $ Ticket     : Factor w/ 363 levels "110469","110489",..: 153 222 74 148 139 262 159 85 101 270 ...
 $ Fare       : num  7.83 7 9.69 8.66 12.29 ...
 $ Cabin      : Factor w/ 77 levels "","A11","A18",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ Embarked   : Factor w/ 3 levels "C","Q","S": 2 3 2 3 3 3 2 3 1 3 ...
> summary(titanic_test)
  PassengerId         Pclass     
 Min.   : 892.0   Min.   :1.000  
 1st Qu.: 996.2   1st Qu.:1.000  
 Median :1100.5   Median :3.000  
 Mean   :1100.5   Mean   :2.266  
 3rd Qu.:1204.8   3rd Qu.:3.000  
 Max.   :1309.0   Max.   :3.000  
                                 
                                        Name         Sex           Age       
 Abbott, Master. Eugene Joseph            :  1   female:152   Min.   : 0.17  
 Abelseth, Miss. Karen Marie              :  1   male  :266   1st Qu.:21.00  
 Abelseth, Mr. Olaus Jorgensen            :  1                Median :27.00  
 Abrahamsson, Mr. Abraham August Johannes :  1                Mean   :30.27  
 Abrahim, Mrs. Joseph (Sophie Halaut Easu):  1                3rd Qu.:39.00  
 Aks, Master. Philip Frank                :  1                Max.   :76.00  
 (Other)                                  :412                NA's   :86     
     SibSp            Parch             Ticket         Fare        
 Min.   :0.0000   Min.   :0.0000   PC 17608:  5   Min.   :  0.000  
 1st Qu.:0.0000   1st Qu.:0.0000   113503  :  4   1st Qu.:  7.896  
 Median :0.0000   Median :0.0000   CA. 2343:  4   Median : 14.454  
 Mean   :0.4474   Mean   :0.3923   16966   :  3   Mean   : 35.627  
 3rd Qu.:1.0000   3rd Qu.:0.0000   220845  :  3   3rd Qu.: 31.500  
 Max.   :8.0000   Max.   :9.0000   347077  :  3   Max.   :512.329  
                                   (Other) :396   NA's   :1        
             Cabin     Embarked
                :327   C:102   
 B57 B59 B63 B66:  3   Q: 46   
 A34            :  2   S:270   
 B45            :  2           
 C101           :  2           
 C116           :  2           
 (Other)        : 80           
> head(titanic_test)
  PassengerId Pclass                                         Name    Sex  Age
1         892      3                             Kelly, Mr. James   male 34.5
2         893      3             Wilkes, Mrs. James (Ellen Needs) female 47.0
3         894      2                    Myles, Mr. Thomas Francis   male 62.0
4         895      3                             Wirz, Mr. Albert   male 27.0
5         896      3 Hirvonen, Mrs. Alexander (Helga E Lindqvist) female 22.0
6         897      3                   Svensson, Mr. Johan Cervin   male 14.0
  SibSp Parch  Ticket    Fare Cabin Embarked
1     0     0  330911  7.8292              Q
2     1     0  363272  7.0000              S
3     0     0  240276  9.6875              Q
4     0     0  315154  8.6625              S
5     1     1 3101298 12.2875              S
6     0     0    7538  9.2250              S
> 
> titanic_train<- read.delim("../input/train.csv", header = T, sep = ",", stringsAsFactors = T)
> str(titanic_train)
'data.frame':	891 obs. of  12 variables:
 $ PassengerId: int  1 2 3 4 5 6 7 8 9 10 ...
 $ Survived   : int  0 1 1 1 0 0 0 0 1 1 ...
 $ Pclass     : int  3 1 3 1 3 3 1 3 3 2 ...
 $ Name       : Factor w/ 891 levels "Abbing, Mr. Anthony",..: 109 191 358 277 16 559 520 629 417 581 ...
 $ Sex        : Factor w/ 2 levels "female","male": 2 1 1 1 2 2 2 2 1 1 ...
 $ Age        : num  22 38 26 35 35 NA 54 2 27 14 ...
 $ SibSp      : int  1 1 0 1 0 0 0 3 0 1 ...
 $ Parch      : int  0 0 0 0 0 0 0 1 2 0 ...
 $ Ticket     : Factor w/ 681 levels "110152","110413",..: 524 597 670 50 473 276 86 396 345 133 ...
 $ Fare       : num  7.25 71.28 7.92 53.1 8.05 ...
 $ Cabin      : Factor w/ 148 levels "","A10","A14",..: 1 83 1 57 1 1 131 1 1 1 ...
 $ Embarked   : Factor w/ 4 levels "","C","Q","S": 4 2 4 4 4 3 4 4 4 2 ...
> summary(titanic_train)
  PassengerId       Survived          Pclass     
 Min.   :  1.0   Min.   :0.0000   Min.   :1.000  
 1st Qu.:223.5   1st Qu.:0.0000   1st Qu.:2.000  
 Median :446.0   Median :0.0000   Median :3.000  
 Mean   :446.0   Mean   :0.3838   Mean   :2.309  
 3rd Qu.:668.5   3rd Qu.:1.0000   3rd Qu.:3.000  
 Max.   :891.0   Max.   :1.0000   Max.   :3.000  
                                                 
                                    Name         Sex           Age       
 Abbing, Mr. Anthony                  :  1   female:314   Min.   : 0.42  
 Abbott, Mr. Rossmore Edward          :  1   male  :577   1st Qu.:20.12  
 Abbott, Mrs. Stanton (Rosa Hunt)     :  1                Median :28.00  
 Abelson, Mr. Samuel                  :  1                Mean   :29.70  
 Abelson, Mrs. Samuel (Hannah Wizosky):  1                3rd Qu.:38.00  
 Adahl, Mr. Mauritz Nils Martin       :  1                Max.   :80.00  
 (Other)                              :885                NA's   :177    
     SibSp           Parch             Ticket         Fare       
 Min.   :0.000   Min.   :0.0000   1601    :  7   Min.   :  0.00  
 1st Qu.:0.000   1st Qu.:0.0000   347082  :  7   1st Qu.:  7.91  
 Median :0.000   Median :0.0000   CA. 2343:  7   Median : 14.45  
 Mean   :0.523   Mean   :0.3816   3101295 :  6   Mean   : 32.20  
 3rd Qu.:1.000   3rd Qu.:0.0000   347088  :  6   3rd Qu.: 31.00  
 Max.   :8.000   Max.   :6.0000   CA 2144 :  6   Max.   :512.33  
                                  (Other) :852                   
         Cabin     Embarked
            :687    :  2   
 B96 B98    :  4   C:168   
 C23 C25 C27:  4   Q: 77   
 G6         :  4   S:644   
 C22 C26    :  3           
 D          :  3           
 (Other)    :186           
> head(titanic_train)
  PassengerId Survived Pclass
1           1        0      3
2           2        1      1
3           3        1      3
4           4        1      1
5           5        0      3
6           6        0      3
                                                 Name    Sex Age SibSp Parch
1                             Braund, Mr. Owen Harris   male  22     1     0
2 Cumings, Mrs. John Bradley (Florence Briggs Thayer) female  38     1     0
3                              Heikkinen, Miss. Laina female  26     0     0
4        Futrelle, Mrs. Jacques Heath (Lily May Peel) female  35     1     0
5                            Allen, Mr. William Henry   male  35     0     0
6                                    Moran, Mr. James   male  NA     0     0
            Ticket    Fare Cabin Embarked
1        A/5 21171  7.2500              S
2         PC 17599 71.2833   C85        C
3 STON/O2. 3101282  7.9250              S
4           113803 53.1000  C123        S
5           373450  8.0500              S
6           330877  8.4583              Q
> 
> titanic_gender<- read.delim("../input/gender_submission.csv", header = T, sep = ",", stringsAsFactors = T)
> head(titanic_gender)
  PassengerId Survived
1         892        0
2         893        1
3         894        0
4         895        0
5         896        1
6         897        0
> 
> library(tidyr)
> 
> #identical(titanic_gender$PassengerId, titanic_test$PassengerId)
> #titanic_merge<- merge(titanic_test, titanic_gender, all.x = T)
> #summary(titanic_merge)
> #head(titanic_merge)
> library(dplyr)
> 
> 
> ###--- DATA CLEANING ---###
> lapply(titanic_train, function(x) length(unique(x)))
$PassengerId
[1] 891

$Survived
[1] 2

$Pclass
[1] 3

$Name
[1] 891

$Sex
[1] 2

$Age
[1] 89

$SibSp
[1] 7

$Parch
[1] 7

$Ticket
[1] 681

$Fare
[1] 248

$Cabin
[1] 148

$Embarked
[1] 4

> 
> #removing columns which are completely unique, not needed for the EDA
> titanic_train<- titanic_train[,-which(lapply(titanic_train, function(x) length(unique(x))) == 891)]
> 
> #checking for NA and fixing
> sum(is.na(titanic_train))
[1] 177
> sapply(titanic_train, function (x) sum(is.na(x)))
Survived   Pclass      Sex      Age    SibSp    Parch   Ticket     Fare 
       0        0        0      177        0        0        0        0 
   Cabin Embarked 
       0        0 
> #only Age column has NAs
> summary(titanic_train$Age) #cannot assume to convert all NAs to either 0 or median of the Age values at this point
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   0.42   20.12   28.00   29.70   38.00   80.00     177 
> 
> #checking for NaN and fixing
> sapply(titanic_train, function (x) sum(is.nan(x)))
Survived   Pclass      Sex      Age    SibSp    Parch   Ticket     Fare 
       0        0        0        0        0        0        0        0 
   Cabin Embarked 
       0        0 
> 
> #checking for NULL and fixing
> sapply(titanic_train, function (x) sum(is.null(x)))
Survived   Pclass      Sex      Age    SibSp    Parch   Ticket     Fare 
       0        0        0        0        0        0        0        0 
   Cabin Embarked 
       0        0 
> 
> 
> #checking for standards of each of the columns
> sapply(titanic_train, class)
 Survived    Pclass       Sex       Age     SibSp     Parch    Ticket      Fare 
"integer" "integer"  "factor" "numeric" "integer" "integer"  "factor" "numeric" 
    Cabin  Embarked 
 "factor"  "factor" 
> titanic_train$Age<- as.integer(titanic_train$Age) #converting Age column to integer as we had age in decimals
> 
> #filtering only the survived passengers
> titanic_train_survived<- titanic_train[which(titanic_train$Survived == 1),]
> str(titanic_train_survived)
'data.frame':	342 obs. of  10 variables:
 $ Survived: int  1 1 1 1 1 1 1 1 1 1 ...
 $ Pclass  : int  1 3 1 3 2 3 1 2 2 3 ...
 $ Sex     : Factor w/ 2 levels "female","male": 1 1 1 1 1 1 1 1 2 1 ...
 $ Age     : int  38 26 35 27 14 4 58 55 NA NA ...
 $ SibSp   : int  1 0 1 0 1 1 0 0 0 0 ...
 $ Parch   : int  0 0 0 2 0 1 0 0 0 0 ...
 $ Ticket  : Factor w/ 681 levels "110152","110413",..: 597 670 50 345 133 617 39 154 152 185 ...
 $ Fare    : num  71.28 7.92 53.1 11.13 30.07 ...
 $ Cabin   : Factor w/ 148 levels "","A10","A14",..: 83 1 57 1 1 147 51 1 1 1 ...
 $ Embarked: Factor w/ 4 levels "","C","Q","S": 2 4 4 4 2 4 4 4 4 2 ...
> summary(titanic_train_survived)
    Survived     Pclass         Sex           Age            SibSp       
 Min.   :1   Min.   :1.00   female:233   Min.   : 0.00   Min.   :0.0000  
 1st Qu.:1   1st Qu.:1.00   male  :109   1st Qu.:19.00   1st Qu.:0.0000  
 Median :1   Median :2.00                Median :28.00   Median :0.0000  
 Mean   :1   Mean   :1.95                Mean   :28.32   Mean   :0.4737  
 3rd Qu.:1   3rd Qu.:3.00                3rd Qu.:36.00   3rd Qu.:1.0000  
 Max.   :1   Max.   :3.00                Max.   :80.00   Max.   :4.0000  
                                         NA's   :52                      
     Parch            Ticket         Fare            Cabin     Embarked
 Min.   :0.0000   1601   :  5   Min.   :  0.00          :206    :  2   
 1st Qu.:0.0000   113760 :  4   1st Qu.: 12.47   B96 B98:  4   C: 93   
 Median :0.0000   2666   :  4   Median : 26.00   E101   :  3   Q: 30   
 Mean   :0.4649   110152 :  3   Mean   : 48.40   F33    :  3   S:217   
 3rd Qu.:1.0000   13502  :  3   3rd Qu.: 57.00   B18    :  2           
 Max.   :5.0000   17421  :  3   Max.   :512.33   B20    :  2           
                  (Other):320                    (Other):122           
> head(titanic_train_survived)
   Survived Pclass    Sex Age SibSp Parch           Ticket    Fare Cabin
2         1      1 female  38     1     0         PC 17599 71.2833   C85
3         1      3 female  26     0     0 STON/O2. 3101282  7.9250      
4         1      1 female  35     1     0           113803 53.1000  C123
9         1      3 female  27     0     2           347742 11.1333      
10        1      2 female  14     1     0           237736 30.0708      
11        1      3 female   4     1     1          PP 9549 16.7000    G6
   Embarked
2         C
3         S
4         S
9         S
10        C
11        S
> 
> #deriving young vs adult
> titanic_train_survived$young<- ifelse(titanic_train_survived$Age <= 18, 1, 0)
> 
> #removing unwanted rows and columns for this EDA
> titanic_train_survived<- titanic_train_survived[,-c(1, 7:9)] #removing survived, tickets, fare and cabin  columns
> sum(is.na(titanic_train_survived$Age))
[1] 52
> titanic_train_survived<- titanic_train_survived[-which(is.na(titanic_train_survived$Age)),]
> 
> 
> 
> ###--- DATA ANALYSIS ---###
> #pclass
> plot(table(titanic_train_survived$Pclass), main = "survivors / pclass", xlab = "pclass", ylab = "count", col = "green")
> 
> #sex
> barplot(table(titanic_train_survived$Sex), main = "male and female survivors proposition", ylab = "count", col = c("red", "blue"), ylim = c(0, 220))
> 
> #age
> hist(titanic_train_survived$Age, main = "survivor age and proposition", xlab = "age range", labels = T, col = "darkmagenta")
> boxplot(titanic_train_survived$Age)
> titanic_train_survived<- titanic_train_survived[-which(titanic_train_survived$Age > 60),]
> 
> #embarked
> barplot(table(titanic_train_survived$Embarked), main = "survivors proposition w.r.t embarkment", ylab = "count")
> subset(titanic_train_survived, Pclass == 1 & Sex == "female" & SibSp == 0 & Parch == 0 & young == 0)
    Pclass    Sex Age SibSp Parch Embarked young
12       1 female  58     0     0        S     0
62       1 female  38     0     0              0
195      1 female  44     0     0        C     0
196      1 female  58     0     0        C     0
219      1 female  32     0     0        C     0
258      1 female  30     0     0        S     0
259      1 female  35     0     0        C     0
270      1 female  35     0     0        S     0
291      1 female  26     0     0        S     0
310      1 female  30     0     0        C     0
311      1 female  24     0     0        C     0
326      1 female  36     0     0        C     0
338      1 female  41     0     0        C     0
370      1 female  24     0     0        C     0
381      1 female  42     0     0        C     0
521      1 female  30     0     0        S     0
538      1 female  30     0     0        C     0
610      1 female  40     0     0        S     0
628      1 female  21     0     0        S     0
642      1 female  24     0     0        C     0
709      1 female  22     0     0        S     0
711      1 female  24     0     0        C     0
717      1 female  38     0     0        C     0
731      1 female  29     0     0        S     0
760      1 female  33     0     0        S     0
797      1 female  49     0     0        S     0
843      1 female  30     0     0        C     0
863      1 female  48     0     0        S     0
888      1 female  19     0     0        S     0
> summary(subset(titanic_train_survived, Pclass == 1 & Sex == "female" & SibSp == 0 & Parch == 0 & young == 0))
     Pclass      Sex          Age            SibSp       Parch   Embarked
 Min.   :1   female:29   Min.   :19.00   Min.   :0   Min.   :0    : 1    
 1st Qu.:1   male  : 0   1st Qu.:26.00   1st Qu.:0   1st Qu.:0   C:15    
 Median :1               Median :32.00   Median :0   Median :0   Q: 0    
 Mean   :1               Mean   :34.14   Mean   :0   Mean   :0   S:13    
 3rd Qu.:1               3rd Qu.:40.00   3rd Qu.:0   3rd Qu.:0           
 Max.   :1               Max.   :58.00   Max.   :0   Max.   :0           
     young  
 Min.   :0  
 1st Qu.:0  
 Median :0  
 Mean   :0  
 3rd Qu.:0  
 Max.   :0  
> #converting 2 blank embarked points to C, since C has more freq w.r.t to the age > 30
> summary(subset(titanic_train_survived, Pclass == 1 & Sex == "female" & SibSp == 0 & Parch == 0 & young == 0 & Age > 30))
     Pclass      Sex          Age           SibSp       Parch   Embarked
 Min.   :1   female:15   Min.   :32.0   Min.   :0   Min.   :0    :1     
 1st Qu.:1   male  : 0   1st Qu.:35.5   1st Qu.:0   1st Qu.:0   C:8     
 Median :1               Median :40.0   Median :0   Median :0   Q:0     
 Mean   :1               Mean   :41.8   Mean   :0   Mean   :0   S:6     
 3rd Qu.:1               3rd Qu.:46.0   3rd Qu.:0   3rd Qu.:0           
 Max.   :1               Max.   :58.0   Max.   :0   Max.   :0           
     young  
 Min.   :0  
 1st Qu.:0  
 Median :0  
 Mean   :0  
 3rd Qu.:0  
 Max.   :0  
> titanic_train_survived[which(titanic_train_survived$Embarked == ""), 6]<- "C"
> 
> summary(titanic_train_survived)
     Pclass          Sex           Age            SibSp            Parch       
 Min.   :1.000   female:194   Min.   : 0.00   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1.000   male  : 91   1st Qu.:19.00   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :2.000                Median :28.00   Median :0.0000   Median :0.0000  
 Mean   :1.877                Mean   :27.66   Mean   :0.4982   Mean   :0.5368  
 3rd Qu.:3.000                3rd Qu.:36.00   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :3.000                Max.   :60.00   Max.   :4.0000   Max.   :5.0000  
 Embarked     young       
  :  0    Min.   :0.0000  
 C: 80    1st Qu.:0.0000  
 Q:  8    Median :0.0000  
 S:197    Mean   :0.2456  
          3rd Qu.:0.0000  
          Max.   :1.0000  
> barplot(table(titanic_train_survived$Embarked), main = "survivors proposition w.r.t embarkment", ylab = "count", col = c("red", "blue", "green"))
> 
> #young vs adult
> barplot(table(titanic_train_survived$young))
> barplot(table(titanic_train_survived$young), main = "adult vs young survivors proposition", ylab = "count", col = c("red", "blue"), ylim = c(0, 250), names.arg = c("adult", "young"))
> 
> 
> ##segmented univariate analysis
> #by sex
> titanic_train_survived_male<- titanic_train_survived[titanic_train_survived$Sex == "male",]
> titanic_train_survived_female<- titanic_train_survived[titanic_train_survived$Sex == "female",]
> barplot(table(titanic_train_survived_male$Pclass), ylim = c(0,50)) #Pclass1 and 3 have almost equal number of male survivors
> barplot(table(titanic_train_survived_female$Pclass),  ylim = c(0,100)) #Pclass1 has the most number of female survivors, followed by Pclass 2 and 3
> hist(titanic_train_survived_male$Age, labels = T) #Age between 20-40 has the more male survivors
> hist(titanic_train_survived_female$Age,labels = T, breaks = 8) #Age between 20-40 has the more female survivors
> 
> #by pclass
> titanic_train_survived_class1<- titanic_train_survived[titanic_train_survived$Pclass == 1,]
> titanic_train_survived_class2<- titanic_train_survived[titanic_train_survived$Pclass == 2,]
> titanic_train_survived_class3<- titanic_train_survived[titanic_train_survived$Pclass == 3,]
> barplot(table(titanic_train_survived_class1$Sex)) #female had more chance of being a survivor in Pclass1
> barplot(table(titanic_train_survived_class2$Sex)) #female had more chance of being a survivor in Pclass1
> barplot(table(titanic_train_survived_class3$Sex)) #female had more chance of being a survivor in Pclass1
> hist(titanic_train_survived_class1$Age, labels = T) #Age between 20-40 has the more male and female survivors
> hist(titanic_train_survived_class2$Age, labels = T) #Age between 20-40 has the more male and female survivors
> hist(titanic_train_survived_class3$Age, labels = T) #Age between 0-30 has the more male and female survivors
> 
> #by young
> titanic_train_survived_adult<- titanic_train_survived[titanic_train_survived$young == 0,]
> titanic_train_survived_young<- titanic_train_survived[titanic_train_survived$young == 1,]
> barplot(table(titanic_train_survived_adult$Pclass)) #adults in Pclass1 had the most chance of survival
> barplot(table(titanic_train_survived_young$Pclass)) #youngs in Pclass3 had the most chance of survival, followed by Pclass2 and 1
> barplot(table(titanic_train_survived_adult$Sex)) #adults female had the most chance of survival
> barplot(table(titanic_train_survived_young$Sex)) #youngs female had the most chance of survival
> hist(titanic_train_survived_adult$Age, labels = T) #adults 20-40 age had most chance of survival
> hist(titanic_train_survived_young$Age, breaks = 6, labels = T) #youngs 0-5 age had most chance of survival
> 
> 
> ##Bivariate analysis
> #Pclass and Sex
> library(ggplot2)
> ggplot(titanic_train_survived, aes(titanic_train_survived$Pclass, fill = titanic_train_survived$Sex))+geom_bar()
Warning messages:
1: Use of `titanic_train_survived$Pclass` is discouraged. Use `Pclass` instead. 
2: Use of `titanic_train_survived$Sex` is discouraged. Use `Sex` instead. 
> 
> #Pclass and Age
> ggplot(titanic_train_survived, aes(x = factor(titanic_train_survived$Pclass), y= titanic_train_survived$Age))+geom_boxplot()
Warning messages:
1: Use of `titanic_train_survived$Pclass` is discouraged. Use `Pclass` instead. 
2: Use of `titanic_train_survived$Age` is discouraged. Use `Age` instead. 
> ggplot(titanic_train_survived, aes(x = factor(titanic_train_survived$Pclass), y= titanic_train_survived$Age))+geom_boxplot()+theme_classic()
Warning messages:
1: Use of `titanic_train_survived$Pclass` is discouraged. Use `Pclass` instead. 
2: Use of `titanic_train_survived$Age` is discouraged. Use `Age` instead. 
> 
> #Pclass and young
> ggplot(titanic_train_survived, aes(x = factor(titanic_train_survived$Pclass), fill= titanic_train_survived$Embarked, col = factor(titanic_train_survived$young)))+geom_bar()
Warning messages:
1: Use of `titanic_train_survived$Pclass` is discouraged. Use `Pclass` instead. 
2: Use of `titanic_train_survived$Embarked` is discouraged. Use `Embarked` instead. 
3: Use of `titanic_train_survived$young` is discouraged. Use `young` instead. 
> 
> #Sex and Age
> ggplot(titanic_train_survived, aes(x = factor(titanic_train_survived$Sex), y= titanic_train_survived$Age))+geom_boxplot()+theme_gray()
Warning messages:
1: Use of `titanic_train_survived$Sex` is discouraged. Use `Sex` instead. 
2: Use of `titanic_train_survived$Age` is discouraged. Use `Age` instead. 
> length(which(titanic_train_survived$Sex == "female"))
[1] 194
> length(which(titanic_train_survived$Sex == "male"))
[1] 91
> 
> #Sex and young
> ggplot(titanic_train_survived, aes(x = factor(titanic_train_survived$Sex), y= titanic_train_survived$Age, fill= factor(titanic_train_survived$young)))+geom_boxplot()+theme_gray()
Warning messages:
1: Use of `titanic_train_survived$Sex` is discouraged. Use `Sex` instead. 
2: Use of `titanic_train_survived$Age` is discouraged. Use `Age` instead. 
3: Use of `titanic_train_survived$young` is discouraged. Use `young` instead. 
> ggplot(titanic_train_survived, aes(x = factor(titanic_train_survived$Sex), fill= factor(titanic_train_survived$young)))+geom_bar(position = "dodge")+theme_gray()
Warning messages:
1: Use of `titanic_train_survived$Sex` is discouraged. Use `Sex` instead. 
2: Use of `titanic_train_survived$young` is discouraged. Use `young` instead. 
>        
> #inferrence on Ananlysis:
>        #Embarkked == Southampton, passangers who had embarkked from Southampton had a higher chance of survival, could be cos of filling the front or forward places in the ship and easy to escape
>        #sex == female had more chance of survival
>        #Age >= 20 and <40 had a greater changce of survival
>        #Pcalss == 1 had the most chance of survival
>        #young == 0 (adult), adults had a greater chance of survival
>        
> #combination of all 5 (mentioned above) parameters have the best chance of the survival.
> #combination of 3-4 parameters have the good chance of the survival.
> #combination of 1-2 parameters have the least change of the survival
> 
> 
> 
> proc.time()
   user  system elapsed 
  1.949   0.114   2.070 
