## ---- include=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
library(dplyr) 
library('ggplot2')

train <- read.csv(file='../input/train.csv')
test <- read.csv(file='../input/test.csv')



## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#dimensão dataset de train
dim(train)

#dimensão dataset de teste
dim(test)


## ----include=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

train$Name <- as.character(train$Name)
test$Name <- as.character(test$Name)

train$Survived <- factor(train$Survived)
train$Pclass <- factor(train$Pclass)
train$Parch <- factor(train$Parch)
train$SibSp <- factor(train$SibSp)
train$Sex <- factor(train$Sex)

test$Parch <- factor(test$Parch)
test$Pclass <- factor(test$Pclass)

train$Age[is.na(train$Age)] <- mean(train$Age, na.rm = T)
test$Age[is.na(test$Age)] = mean(test$Age, na.rm = T)



## ---- echo=FALSE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ggplot(train, aes(Sex )) +geom_bar(aes(fill=factor(Survived)))

ggplot(train, aes(Pclass)) + geom_bar(aes(fill=factor(Survived)), alpha=0.6)



## ----include=FALSE---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
head(subset(train,select=c(2,3,5,6,8,8,10,12)),4)

modelo1  = glm(Survived ~. , data = subset(train,select=c(2,3,5,6)), family = binomial)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
summary(modelo1)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

predicted <- predict(modelo1, newdata = subset(test,select=c(2,4,5,6)), type = "response")
test$p[predicted >= 0.5] = 1
test$p[predicted < 0.5] = 0


solution <- data.frame(PassengerId = test$PassengerId, Survived = test$p)
head(solution,10)




## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

MC <- table(train$Survived, predict(modelo1) > 0.5)
MC



## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ACC <- sum(diag(MC))/sum(MC)
ACC



## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
precision <- MC[2,2]/sum(MC[,2])
precision



## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
error <- 1 - ACC
error


