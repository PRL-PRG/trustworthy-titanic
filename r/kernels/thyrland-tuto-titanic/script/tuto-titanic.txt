

# This R script will run on our backend. You can write arbitrary code here!

# Many standard libraries are already installed, such as randomForest
library(randomForest)

# The train and test data is stored in the ../input directory
train <- read.csv("../input/train.csv")
test  <- read.csv("../input/test.csv")

# We can inspect the train data. The results of this are printed in the log tab below
str(train)


# Likely usefull variables to predict if a passenger survived are: 
# - Pclass
# - Sex
# - Age
# - SibSp
# - Parch
# - Fare (even though this one should be stronlgy correlated to "Cabin")
# - Embarked (not sure about this one for the moment though)

# Create logistic regression model to check the most significant variables
TTCLog = glm(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked, data = train, family = "binomial")
summary(TTCLog)

# Create an optimized logistic regression model using only the most significant variables
TTCLogOpt = glm(Survived ~ Pclass + Sex + Age + SibSp, data = train, family = "binomial")
summary(TTCLogOpt)

# Make predictions on the testing set
TTCLogOptPred = predict(TTCLogOpt, newdata = test, type = "response")


str(test)


